# ç›®å½•
- ç§åº“æ€ä¹ˆä¸Šä¼ æµ‹è¯•sdk
- bintrayæ€ä¹ˆé€šè¿‡apiåˆ åº“
- 

## è·å–appçš„SHA256

- keytool -list -v -keystore minp.jks 
- keytool -printcert -jarfile ./minp-debug.apk
- keytool -printcert -jarfile ./minp-release.apk  ä¸åŒçš„åŒ…å¯¹åº”ä¸åŒçš„æŒ‡ä»¤

## ç»©æ•ˆå†™æ³•
- Bug SLA bugè´¨é‡
- Bug RCA bugå¤ç›˜


## æœ¬åœ°å‘ç‰ˆåŸ‹ç‚¹sdk
```
#!/usr/bin/env bash

# ç”¨äºå‘å¸ƒAndroid SDKåˆ°jcenterä¸Š
# æ­¤è„šæœ¬éœ€è¦ç¯å¢ƒå˜é‡å¦‚ä¸‹:
# pb_pf: å‘å¸ƒæ–¹å¼ï¼š test official
# pb_vs: å‘å¸ƒç‰ˆæœ¬
# pb_vaa: æ˜¯å¦å‘å¸ƒvds-android-agent
# pb_vgp: æ˜¯å¦å‘å¸ƒgradle-plugin
# pb_all: æ˜¯å¦éœ€å…¨é‡å‘å¸ƒ

set -e
pb_pf="official"
pb_vs="2.8.20"
pb_vaa=true
pb_rva=true
pb_vgp=true
pb_all=true

function publish(){
	versionName=$1
	echo "å¼€å§‹å‘å¸ƒç‰ˆæœ¬:" $versionName
	# bintrayUploadä¼šé¦–å…ˆåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
	./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp clean assembleAar :vds-gradle-plugin:install
	./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp bintrayUpload --info
}

if [ "$pb_all" == "true" ]
else
	echo "å‘å¸ƒå•ä¸ªç‰ˆæœ¬ï¼š" $pb_vs
	publish $pb_vs
fi

echo "================== å‘å¸ƒå®Œæˆ ==================== "

```

CDP
```
#!/usr/bin/env bash

# ç”¨äºå‘å¸ƒAndroid SDKåˆ°jcenterä¸Š
# æ­¤è„šæœ¬éœ€è¦ç¯å¢ƒå˜é‡å¦‚ä¸‹:
# pb_pf: å‘å¸ƒæ–¹å¼ï¼š test official
# pb_vs: å‘å¸ƒç‰ˆæœ¬
# pb_vaa: æ˜¯å¦å‘å¸ƒvds-android-agent
# pb_vgp: æ˜¯å¦å‘å¸ƒgradle-plugin
# pb_all: æ˜¯å¦éœ€å…¨é‡å‘å¸ƒ

set -e
pb_pf="official"
pb_vs="cdp-1.2.4"
pb_vaa=true
pb_rva=true
pb_vgp=false
pb_all=false

./gradlew clean
&& ./gradlew test

function publish(){
  versionName=$1
  echo "å¼€å§‹å‘å¸ƒç‰ˆæœ¬:" $versionName
  # bintrayUploadä¼šé¦–å…ˆåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  ./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp assembleAar :vds-gradle-plugin:install
  ./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp bintrayUpload --info
}

if [ "$pb_all" == "true" ]
then
  echo "å‘å¸ƒå…¨é‡ç‰ˆæœ¬ï¼š RN-autotrack-"$pb_vs ", autotrack-"$pb_vs ", RN-track-"$pb_vs ", track-"$pb_vs
  publish RN-autotrack-$pb_vs
  publish RN-track-$pb_vs
  publish track-$pb_vs
  publish autotrack-$pb_vs
else
  echo "å‘å¸ƒå•ä¸ªç‰ˆæœ¬ï¼š" $pb_vs
  publish $pb_vs
fi

echo "================== å‘å¸ƒå®Œæˆ ==================== "
å·²è¯»

```

## deeplinkè·³è½¬å†…éƒ¨é¡µ
å‰ªåˆ‡æ¿è®¾è®¡æ–‡æ¡£ï¼šhttps://growingio.atlassian.net/wiki/spaces/ads/pages/942310739/Deferred+Deeplink

```
.setDeeplinkCallback(new DeeplinkCallback() {
    @Override
    public void onReceive(Map<String, String> params, int error, long tmClick) {
        LogUtil.d("RApplication", "params  -->" + params + "  error  -->" + error + " tmClick  -->" + tmClick);
        Intent intent = new Intent();
        intent.setClass(getApplicationContext(), TestPageActivity.class);
        intent.putExtra("name",params.get("name"));
        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(intent);
    }
})
```


## minp-cdp
meizu
```
2020-07-08 10:38:04.131 8468-8491/com.growingio.minp W/GIO.DBAdapter: save instant Message: {"s":"04a07a83-13b8-4b4a-a329-9ff976ebb1ae","t":"user","tm":1594175884106,"gioId":"meizu_lisi","d":"com.growingio.minp","cs1":"meizu_lisi","var":{"gio_push_channel":"Meizu","gio_push_token":"Z496e0602745b634502000c4a7d000542796501017f50","gio_push_package":"com.growingio.minp","gio_notification_enabled":true,"gio_push_device_brand":"Meizu"},"gesid":38,"esid":14}
```
vivoèƒ½å”¤é†’èƒ½ä¸ŠæŠ¥æµ‹è¯•æœºä¿¡æ¯
```
2020-07-09 10:10:52.843 11451-11473/com.growingio.minp D/GIO.MessageUploader: GIO-CDP cstm : # io.growing.collector.tunnel.protocol.EventDto@97e413c1
    anonymous_id: "a9ea231c-d329-35c8-b1c7-97f23266dfe8"
    context {
      device {
        platform: "Android"
      }
    }
    data_source_id: "898c864030bcdabe"
    esid: 13
    event_key: "gio_touch_message_change"
    gio_id: "vivo_lisi"
    project_key: "a500f222e29e3b0c"
    send_time: 1594260652800
    session: "7027651e-e269-44e6-8137-5326da06eb3b"
    timestamp: 1594260651630
    type: CUSTOM_EVENT
    type_value: 1
    user_id: "vivo_lisi"
    attributes {description=}
```

## demoè·å–oaidçš„æ–¹æ³•
- OaidHelperé‡Œæœ‰ç›¸å…³çš„æ–¹æ³•ï¼Œè°ƒç”¨å³å¯
ç›¸å…³taskï¼šhttps://growingio.atlassian.net/browse/PI-25237

- é”™è¯¯ä¿¡æ¯
![](2020-08-10-16-08-51.png)

- jsonç­‰é™æ€æ–‡ä»¶æ”¾åœ¨src/main/assetsè·¯å¾„ä¸‹å³å¯

## è·å–deeplinkå‰ªåˆ‡æ¿å†…å®¹
é€šè¿‡`ç”¨æˆ·é€šè¿‡å»¶è¿Ÿæ·±åº¦é“¾æ¥æ–¹å¼æ‰“å¼€` åœ¨gandroidé¡¹ç›®é‡Œæœç´¢åˆ°ç›¸å…³åˆ¤æ–­æºç ï¼Œå°†é‡Œé¢çš„éƒ¨åˆ†æºç ç²˜è´´åˆ°demoé‡Œï¼Œç‚¹å‡»æŒ‰é’®æ‰§è¡Œè¿™éƒ¨åˆ†æºç ï¼Œå¹¶æ‰“å°log
```
ClipboardManager cm = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);
ClipData clipData = cm != null ? cm.getPrimaryClip() : null;
ClipData.Item item = clipData.getItemAt(0);
String mimeType = clipData.getDescription().getMimeType(0);
Log.e(TAG, "onClick: mimeType = "+mimeType);
```

## æ’æŸ¥ASæ‰“åŒ…å¼‚å¸¸é—®é¢˜
- ./gradlew :[moduleName]:taskName -d
- æˆ–assembleä¸€ä¸‹
- æç¤ºæŸä¸ªæ¨¡å—çš„classNotFoundï¼Œå»å¯¹åº”çš„æ¨¡å—æ‰§è¡ŒbundLibRuntimeDebug

## æŸ¥gdp-testç¯å¢ƒç›¸å…³çš„ipåœ°å€

æŸ¥çœ‹æœåŠ¡ http://gdp-test.growingio.com/_dashboard/hosts
é‡å¯æœåŠ¡ http://gdp-test.growingio.com/_dashboard/

## debugæ’æŸ¥dexä»£ç 
appåŒæ­¥å¥½ä¹‹åï¼Œåœ¨å¼•ç”¨çš„åŒ…å†…å¯¹åº”çš„ä»£ç å‡ºæ‰“æ–­ç‚¹ï¼Œåœ¨ç”¨asçš„debugæ¨¡å¼å®‰è£…

## æµ‹è¯•cdp web/h5 å¼¹çª—

pngå›¾ç‰‡åœ°å€ï¼šhttp://www.kejidi.cn/uploads/allimg/180906/11305W195-1.png

- cdpåŸ‹ç‚¹sdk https://codes.growingio.com/D17427
å‘ç‰ˆè®°å½• https://growingio.atlassian.net/wiki/spaces/FEW/pages/1189939681/cdp+js+sdk
CDPæ–‡æ¡£ https://growingio.atlassian.net/wiki/spaces/CDP/pages/988938289/CDP+JS+SDK
- æµ‹è¯•ç¯å¢ƒå‘ç‰ˆjob shttp://jenkins.infra.growingio.com/view/Staging/job/cdp-web-js-sdk_wanghaiming/
- æµ‹è¯•åœ°å€ https://assets.giocdn.com/cdp-release/1.0/gio-test.js
- cdpè§¦è¾¾sdk https://codes.growingio.com/D17464

## 20200709å‘ç‰ˆé£é™©
- gtouch æ”¹äº†maæ¥å£çš„è¯·æ±‚è·¯å¾„ï¼Œéœ€è¦æœåŠ¡ç«¯æ–°è€æ¥å£éƒ½èƒ½ç”¨
- adapter-bury-cdp æœ€ä½è¦æ±‚ä½¿ç”¨1.2.3-cdp ,å¦åˆ™appè¿è¡Œå¥”æºƒã€‚ä»¥åæ‰“åŒ…ç¼–è¯‘æ—¶éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚

## æ”¶åˆ°å”¤é†’appçš„æ–¹æ³•
æœ‰äº›æµè§ˆå™¨ä¸è§£æhttpåè®®çš„å”¤é†’é“¾æ¥ï¼Œå¯¼è‡´ç³»ç»Ÿä¸æ›´æ–°å¹¶å¹¿æ’­å…¨å±€intentä¿¡æ¯ã€‚
æ­¤æ—¶å¯ä»¥ç”¨inspect with chrome æ‰‹åŠ¨è·å–é“¾æ¥htmlé‡Œçš„location.href ä¿¡æ¯ï¼Œå¹¶åœ¨consoleé‡Œæ‰§è¡Œã€‚å°±å¯ä»¥æ‰‹åŠ¨å”¤é†’
gtoucå”¤é†’é€»è¾‘é»˜è®¤å†·å¯åŠ¨ï¼Œçƒ­å¯åŠ¨éœ€è¦æ‰§è¡Œåœ¨Applicationçš„onNewIntentç”Ÿå‘½å‘¨æœŸé‡Œæ‰§è¡ŒGrowingIO.getInstance().onNewIntent(this, intent);

## cdpæ¨é€
- tokené€šè¿‡useräº‹ä»¶ä¸ŠæŠ¥ï¼ˆæœ‰æ— cséƒ½æ˜¯é€šè¿‡useräº‹ä»¶ï¼‰
- vivoï¼š15724355870131603348382

## cdpæ¨é€æ•°æ®æŸ¥è¯¢
```
%spark
select 
    * 
from 
    gio.custom_event 
where 
    time between '${startAt}' and '${endAt}' 
    and es_map['gio_push_message_name'] = '${push_name}' limit 10
```




## æ¨é€æ–‡æ¡£
[åä¸ºæ¨é€](https://developer.huawei.com/consumer/cn/service/hms/catalog/huaweipush_agent.html?page=hmssdk_huaweipush_introduction_agent)
- æ¯ç§’ç™¾äº¿ æ”¯æŒå®æ—¶æ¶ˆæ¯å›æ‰§
- å•å‘ã€ç¾¤å‘
- ç”¨æˆ·ä¸åœ¨çº¿ï¼Œæ¨é€æ¶ˆæ¯é»˜è®¤ä¿å­˜24å°æ—¶ï¼Œæœ€å¤§15å¤©ã€‚
- ç»Ÿä¸€NCä¸­å¿ƒç®¡ç†æ¨é€
**é€è¾¾ç‡ä½**
- è®¾å¤‡ä¸åœ¨çº¿ï¼Œä¸”åœ¨çº¿åè¿˜æ˜¯å‘ä¸é€š
- åº”ç”¨è¢«å¸è½½
- ç½‘ç»œä¸ç¨³å®š
- éåä¸ºæ‰‹æœºæœªå®‰è£… Huawei Mobile Services apk
- æ‰‹æœºç®¡å®¶æ‹¦æˆªäº†
**å…¶ä»–æƒ…å†µ**
- åŒ…åæœ€å¤§128å­—èŠ‚
- æ¶ˆæ¯å†…å®¹æœ€å¤§2k
- å¼€å‘æœåŠ¡å™¨çŸ­æ—¶é—´å¤§é‡æ¨é€ä¼šè¢«é™æµ è¿”å›503
- ç”³è¯·token GetTokenHandler.onResultè¿”å›æ¥å£è°ƒç”¨æ˜¯å¦æˆåŠŸï¼Œä½†ä»¥å¹¿æ’­å½¢å¼è¿”å›tokenç»™åº”ç”¨
- å»ºè®®æ¯æ¬¡å¯åŠ¨appæ—¶è°ƒç”¨getToken,æœ‰æ•ˆæœŸå†…è·å–çš„tokenå€¼ä¸å˜åŒ–
**é€šçŸ¥æ **
- æ‰“å¼€åº”ç”¨
- æ‰“å¼€ç½‘é¡µ
- æ‰“å¼€åº”ç”¨å†…ç•Œé¢
**é€ä¼ **
- å¥½å‹é‚€è¯·ï¼Œçº¿ä¸Šæ¥å£èƒ½åŠ›
- 



[oppoæ¨é€]()
[vivoæ¨é€]()

[å°ç±³æ¨é€]()
**å…¶ä»–æƒ…å†µ**
- å®æ—¶æ•°æ® å½“å¤©æ¯ä¸ªæ•´ç‚¹æ¨é€æ€»é‡
- è®¡åˆ’æ¨é€æ•° åŸå§‹è¯·æ±‚æ•°
- æœ‰æ•ˆè®¾å¤‡æ•° è¿‡æ»¤æ‰æ— æ•ˆè®¾å¤‡ï¼Œä¸ç¬¦åˆæ¡ä»¶çš„è®¾å¤‡
- å®é™…ä¸‹å‘æ•° æœåŠ¡å™¨å®é™…å‘å‡ºæ•°é‡
- é€è¾¾æ•° è¿”å›é€è¾¾å›æ‰§çš„æ•°é‡
- å±•ç¤ºæ•° 
- ç‚¹å‡»æ•°



## å„ä¸ªç¯å¢ƒ
.setWsHost("wss://ws-release.growingio.com")
.setDataHost("http://www-release.growingio.com")
.setGtaHost("https://gta-release.growingio.com")

## å¸¸ç”¨ä¸šåŠ¡
äº‹ä»¶å˜é‡--æ•°å€¼å‹å˜é‡--xxæ±‚å’Œä¸xxæ±‚å¹³å‡
ç”¨æˆ·å˜é‡--æœ€ç»ˆä¸æœ€è¿‘çš„åŒºåˆ«ã€‚ç”¨æˆ·å˜é‡å¸¸åœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆäº‹ä»¶è¯¥ä¸æ”¹å˜å‰çš„å˜é‡ç»‘å®šè¿˜æ˜¯ä¸æ”¹å˜åçš„å˜é‡ç»‘å®šå‘¢ã€‚
- æœ€ç»ˆï¼šé—¯å…³æˆåŠŸç¬¬å››å…³ï¼Œé—¯å…³æˆåŠŸè¿™ä»¶äº‹ä¸ç¬¬å››å…³ç»‘å®š
- æœ€è¿‘ï¼šé—¯å…³æˆåŠŸç¬¬å››å…³ï¼Œé—¯å…³æˆåŠŸè¿™ä»¶äº‹ä¸ç¬¬ä¸‰å…³ç»‘å®š

è½¬åŒ–å˜é‡--ç±»ä¼¼äºäº‹ä»¶å˜é‡
- è´­ä¹°äº‹ä»¶ ä¸ å“ªä¸ªæ´»åŠ¨é¡µé¢æœ‰å…³ï¼Ÿ
- æœç´¢å…³é”®è¯ ä¸ ç«™å†…æœç´¢ ä¸å¯èƒ½ä¸€ç›´å…³è”åœ¨ä¸€èµ·ï¼Œéœ€è¦æœ‰ä¸ªå¤±æ•ˆæ—¶é—´ã€‚è®¿é—®ç»“æŸå°±å¤±æ•ˆï¼Œä¸€å¤©/ä¸€å‘¨/ä¸€æœˆå°±å¤±æ•ˆ

äº‹ä»¶åˆå¹¶--ABCä¸‰ä¸ªäº‹ä»¶åˆå¹¶ == å®Œæˆè¿‡Aæˆ–Bæˆ–Cäº‹ä»¶çš„å»é‡æ€»ç”¨æˆ·æ•°+æ¬¡æ•°

æ¸—é€ç‡å°±æ˜¯è¦†ç›–ç‡
## checkUseræ¥å£
è§¦è¾¾maæœåŠ¡è¯·æ±‚äº†ä¸€ä¸ªcheckUseræ¥å£ï¼Œå°†u,csid,ä¼ ç»™æ•°æ®ç«¯ï¼Œè¿”å›

- ä½¿ç”¨æ–‡æ¡£ï¼š
https://codes.growingio.com/w/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%96%87%E6%A1%A3%E9%A6%96%E9%A1%B5/%E8%A7%A6%E8%BE%BE%E8%AF%B4%E6%98%8E/%E8%A7%A6%E8%BE%BE%E6%95%B0%E6%8D%AE%E7%AB%AF%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/

çº¿ä¸Šè§¦è¾¾qsï¼šhttp://internal-query-touch-2022208046.cn-north-1.elb.amazonaws.com.cn:6060/stat/segment/checkUser
çº¿ä¸Šå…¬å…±qs:http://m6qs1:6060
æµ‹è¯•ç¯å¢ƒqs:http://10.1.1.62:6060ã€http://10.1.1.62:6067ã€http://10.1.1.62:6068


## å¸¸ç”¨çŸ­ä¿¡æ–‡æ¡£
é˜¿é‡Œäº‘ï¼šhttps://help.aliyun.com/document_detail/101414.html?spm=a2c4g.11186623.2.13.238d3e2c5i0piV
äº‘ç‰‡ï¼šhttps://www.yunpian.com/official/document/sms/zh_CN/intl_list
åˆ›è“ï¼šhttps://zz.253.com/api_doc/guo-ji-duan-xin/guo-ji-duan-xin-dan-fa-jie-kou/guo-ji-qun-fa-jie-kou.html

## å¸¸ç”¨æ¨é€æ–‡æ¡£


## å¸¸ç”¨é“¾æ¥
- å®¢æˆ·ä½¿ç”¨è§¦è¾¾é¡µé¢æƒ…å†µ https://www.growingio.com/projects/nxog09md/product-analytics/dashboards/woVev1WP

## JIRAä½¿ç”¨
```
created >= 2019-12-21 AND created < 2019-12-28 AND project in (PI, HZPI) AND issuetype in ("Production Issue", "Mobile SDK Bug") AND priority not in ("P3 - Sprint") AND status != CANCELED AND "Develop Team" = "SDK ç»„" AND priority = "P2 - One Week" ORDER BY status ASC, priority DESC, created DESC
```

æŸ¥issueåˆ—è¡¨
```
issuetype = "Production Issue" AND priority in ("P0 - ASAP","P1 - 24h","P2 - One Week") AND  status not in (CANCELED,Closed,Done) AND (Product in ("A/B æµ‹è¯•åœºæ™¯åº”ç”¨", "A/B æµ‹è¯•èƒ½åŠ›", "App å†…å¼¹çª—", "Web å†…å¼¹çª—", ç”¨æˆ·è¿è¥) OR project in (HZPI)) ORDER BY priority DESC 
```

## RESTFULè§„èŒƒ
201 Created èµ„æºæˆåŠŸåˆ›å»º poståˆ›å»º putæ›´æ–°
202 Accepted æäº¤æ¿€æ´»ä»»åŠ¡ putæäº¤
200 OK æ¿€æ´»å®Œæˆ
102 Processing è¿˜åœ¨è¿›è¡Œä¸­
204 No Content 

301 Moved Permanently
303 See Other
304 Not Modified èµ„æºæœªè¢«ä¿®æ”¹

400 Bad Request å‚æ•°é”™è¯¯
401 Unauthorized æœªæˆæƒ
403 Forbidden è®¿é—®å—é™ï¼Œæƒé™è¿‡æœŸ
404 Not Found æœåŠ¡ èµ„æºæœªæ‰¾åˆ°
405 Method Not Allowed ç¦æ­¢çš„httpæ–¹æ³•
406 Not Acceptable åª’ä½“å†…å®¹ä¸ç¬¦åˆè¦æ±‚
408 Request Timeout è¯·æ±‚è¶…æ—¶
409 Conflict èµ„æºå†²çªï¼Œé‡å¤èµ„æº
415 Unprocessable Enity ä¸æ”¯æŒçš„æ•°æ®ç±»å‹
422 Unprocessable Enity è¯·æ±‚æ ¼å¼æ­£ç¡® ä½†è¯­ä¹‰é”™è¯¯æ— æ³•å“åº”
423 Locked
429 Too Many Requests è¯·æ±‚è¿‡å¤šè¢«é™åˆ¶

500 Internal Server Error ç³»ç»Ÿå†…éƒ¨é”™è¯¯
501 Not Implementend æ¥å£æœªå®ç°

## å°ç¨‹åºèµ°è¯»
Marketingç±»ï¼Œ
init åˆå§‹åŒ–
update ç»„ä»¶æ˜¾ç¤º
destrory ç»„ä»¶é”€æ¯
disabled ç»„ä»¶æœªé”€æ¯ï¼Œéšè—

å¼¹çª—æœºåˆ¶ï¼š
- ä¼˜å…ˆé‡‡é›†äº‹ä»¶æ•°æ®
- å¼¹çª—ä¿¡æ¯å›æ¥å‰ï¼Œå…ˆç¼“å­˜äº‹ä»¶ä¿¡æ¯
- å¼¹çª—ä¿¡æ¯å›æ¥åï¼Œæ¶ˆè´¹å¹¶æ¸…ç©º
- ä¹‹åçš„äº‹ä»¶ä¿¡æ¯ç›´æ¥ä¸å¼¹çª—ä¿¡æ¯åŒ¹é…
- é¢„è§ˆå¼¹çª—ä¸è¿›è¡Œä¿¡æ¯åŒ¹é…ï¼Œç›´æ¥å¼¹çª—

ä¿è¯ in_app_message_imp  in_app_message_click  in_app_message_close æ­£å¸¸ä¸ŠæŠ¥

## ä»€ä¹ˆæ—¶å€™å¸¦u
appå¯åŠ¨æ—¶ è·å–æœ¬åœ°bu --> æœ‰åˆ™ä½¿ç”¨buæ— åˆ™ä½¿ç”¨u --> è·å–æœ¬åœ°bcs  --> æœ‰åˆ™ä½¿ç”¨bcsæ— åˆ™ä½¿ç”¨æœ¬åœ°cs --> æœ¬åœ°æ²¡æœ‰csçš„è¯åˆ™bcsï¼Œcséƒ½ä¸ä½¿ç”¨


### æ ¸å¿ƒå®ä¾‹
- å…¨å±€å®ä¾‹
  - gio
  - growingio
  - gioEmitter
  - growingio.marketingHost 
  - getParameterByName()
- StatusStorageç±»
  - _get(messageId, cs1)æ˜¯è€æ•°æ®çš„è¯åˆ™è¿”å›å¯¹åº”çš„valueå¹¶ä»ç¼“å­˜é‡Œæ¸…é™¤æ‰å®ƒä»¬
  - _set(messageId, cs1, v)æœ‰messageId,cs1,valueå³å¯ä¿å­˜åˆ°ç¼“å­˜é‡Œ
  - get(messageId, cs1) ä»_getæ‹¿åˆ°valueï¼Œæœ¬åœ°æ²¡æœ‰ç¼“å­˜è¿‡çš„messageç»™äºˆé»˜è®¤showTimesï¼ŒshowDate.æœ¬åœ°ç¼“å­˜è¿‡çš„messageï¼Œjsonæ·»åŠ showTimesï¼ŒshowDateï¼Œæœ€ç»ˆè¿”å›valueã€‚æ ¸å¿ƒå°±æ˜¯è¿”å›ä¸€ä¸ªæœ‰messageIdï¼Œcs1,showTimes,showDateçš„value
  - plus(messageId, cs1, key, num) v[key]=v[key]+num , this._set(messageId, cs1, v)
- UserStorageç±»
  - namespace:[push-user-status],duration:50å¤©
  - _get(key) key=messageId+cs1
  - set(key, value) æ˜¯æ–°æ•°æ®åˆ™value+ startAt.æ˜¯æ—§æ•°æ®çš„è¯valueæœ‰å˜åŠ¨æ—¶åˆ™æ›´æ–°startAtå¹¶è¦†ç›–ï¼Œæ—§æ•°æ®æ²¡å˜åŒ–çš„è¯åˆ™ä¸åŠ¨å®ƒã€‚
  - get(key) æœ‰æ•ˆæœŸå†…çš„å¼¹çª—valueå¯ä»¥è¿”å›ï¼Œè¿‡æœŸçš„valueä¸è¿”è¿˜ã€‚æœ‰æ•ˆæœŸï¼šæœ€è¿‘ä¸€æ¬¡valueæ›´æ–°æ—¶é—´+50å¤©
- Marketingç±»
  - console.log('Marketing å¯åŠ¨.');
  - statusStorage:[push-status]
  - userStorage:[push-user-status]
  - isPreview
  - isRequested
  - isDispatching æ˜¯å¦æœ‰æ´¾å‘ä¸­çš„äº‹ä»¶
  - listener
  - fetchedMessages è¯·æ±‚å›æ¥çš„å¼¹çª—ä¿¡æ¯
  - renderQueue ç­‰å¾…æ¸²æŸ“çš„å¼¹çª—é˜Ÿåˆ—ï¼Œå¤šäº‹ä»¶åŒæ—¶è§¦å‘æ—¶
  - unResolvedEvents æœªå¤„ç†çš„äº‹ä»¶é˜Ÿåˆ—ï¼Œç”¨äºå¤„ç†å¼¹çª—ä¿¡æ¯æœªå›æ¥å‰çš„äº‹ä»¶ï¼Œä½¿å…¶ä¸è‡³äºé—æ¼

  - handleCS1
  - handleClearCs1
  - handleEvent
  - addGlobalEventListener

  - init() addEventListener()
  - update() å®ä¾‹æ˜¾ç¤ºæ—¶è§¦å‘ refetchPushMessage() 
  - disabled() å®ä¾‹éšè—æ—¶è§¦å‘ resetState();setPreviewState();æ¸…ç©ºæ¸²æŸ“äº‹ä»¶é˜Ÿåˆ—ï¼Œå¾…æ¶ˆè´¹äº‹ä»¶é˜Ÿåˆ—ä¸å¼¹çª—æ•°æ®
  - destroy() disabled();isInit=false;removeEventListener
  - addEventListener() ç›‘å¬appOpenï¼Œuploadäº‹ä»¶
  - removeEventListener() å…³é—­ç›‘å¬xxäº‹ä»¶
  - gatherUnResolvedEvents()
  - clearUnResolvedEvents()
  - clearFetchedMessages()
  
  - formatUrl() è·å–bu; bcs; u=growingio.info.uid, cs1=gio('getUserId')
    - projectId = growingio.vdsConfig.projectId;url_scheme=growingio.vdsConfig.appId
  
  - fetchPushMessage() è¯·æ±‚urlï¼Œset bcsä¸buï¼Œè·å–popupWindowsæ—¶æŒ‰updateAtæ’åºï¼Œå¤±è´¥çš„è¯

  - fetchPreviewPushMessage(messageId) triggerListener(previewMessages[0])
  - refetchPushMessage() é‡ç½®isRequestedå‚æ•°ï¼ŒclearFetchedMessages()å†fetchPushMessage(),æœ€åå®šæ—¶ä¸‹this.timeræ¯30åˆ†é’Ÿè¯·æ±‚ä¸€æ¬¡

  - consumeUnResolvedEvents(event) æ ¹æ®äº‹ä»¶è¿‡æ»¤fetchedMessagesç”ŸæˆvalidMessagesï¼Œé»˜è®¤åªå°†ç¬¬ä¸€ä¸ªæ”¾å…¥æ¸²æŸ“é˜Ÿåˆ—é‡Œ renderQueue.push(validMessages[0])
  - æ‰€è°“æ¶ˆè´¹äº‹ä»¶å°±æ˜¯å°†å®ƒæ”¾å…¥ç­‰å¾…é˜Ÿåˆ—é‡Œ,å› ä¸ºæ˜¯åœ¨fetchPushMessageæˆåŠŸæ—¶æ‰§è¡ŒconsumeUnResolvedEventsçš„ã€‚å¦‚æœæ­¤æ—¶æ²¡æœ‰äº‹ä»¶æ•è·çš„è¯ï¼Œä¸”æœ‰æœªå¤„ç†çš„äº‹ä»¶å°±æ¶ˆè´¹æœªå¤„ç†äº‹ä»¶é˜Ÿåˆ—é‡Œçš„ç¬¬ä¸€ä¸ªäº‹ä»¶

- consumeNextMessage isDispatchingæ˜¯falseçš„è¯ï¼Œæ‰§è¡ŒdispatchMessage()
- dispatchMessage() isDispatchingæ˜¯falseæ—¶ï¼Œä»æ¸²æŸ“é˜Ÿåˆ—é‡Œæå‡ºç¬¬ä¸€ä¸ªmessageï¼ŒtriggerListener(message)
- getValidMessages(event,messages) validActionTypeï¼ŒvalidTimeRangeï¼ŒvalidateTriggerCdï¼ŒvalidateTimes

- onTrackImp(message) ä¸ŠæŠ¥å¼¹çª—äº‹ä»¶åï¼Œå¢åŠ showtimesï¼Œæ›´æ–°cdæ—¶é—´ç‚¹
- onCloseWindow(message) åˆ†å‘æ¶ˆæ¯
- onClickTarget
- [ä¿®æ”¹ç‰ˆæœ¬platform.config.jsé‡Œçš„sdkVer]
## webå¼¹çª—æ•°

- huangrichao's MBP æœ¬åœ°demoçš„u:
- huangrichaoçš„csidï¼š166109
- haungrichaoçš„uï¼š7ec7c657-1681-464a-be89-bdca2d51f6a1

## æ¨é€éš¾é¢˜

Push Token ï¼šç”¨äºå‘é€ç”¨æˆ·æ¶ˆæ¯ è®¿é—®ç”¨æˆ·å˜é‡ setVisitor
Push Arrived ï¼šç”¨æˆ·ç»Ÿè®¡Pushåˆ°è¾¾ç‡ cstm gio_push_message_arrived
Push Clicked ï¼šç”¨æˆ·ç»Ÿè®¡ç”¨æˆ·æ¶ˆæ¯ç‚¹å‡» cstm gio_push_message_clicked
Notification Enabled ï¼šAPPé€šçŸ¥æ æ¶ˆæ¯æƒé™æ˜¯å¦æ‰“å¼€

æœåŠ¡ç«¯åŸ‹ç‚¹ï¼šgio_push_message_sent

æ¨é€

```
é€è¾¾ç‡ä½çš„åŸå› ï¼ŒGrowingIOä½¿ç”¨çš„æ˜¯gio_push_tokenè¿™ä¸ªè®¿é—®ç”¨æˆ·å˜é‡ï¼Œå†…å®¹æ˜¯æ¯ä¸ªè®¿é—®ç”¨æˆ·uå¯¹åº”çš„å‚å•†é€šé“ç»™å‡ºçš„regester_id.
å¤§éƒ¨åˆ†å‚å•†ï¼Œåªè¦ä½ å¸è½½é‡è£…app regester_idéƒ½ä¼šå˜ã€‚vivoåªè¦ä½ æ‰§è¡Œunregisted()ï¼Œregester_idéƒ½ä¼šå˜

RegIDåœ¨åº”ç”¨å¸è½½æˆ–æ¸…é™¤æœ¬åœ°æ•°æ®æˆ–è€…90å¤©ä¸è”ç½‘åä¼šé‡æ–°ç”Ÿæˆ
```
- ç”¨æˆ·éœ€è¦æ‰“å¼€æ¨é€æƒé™
  


## OPPO PUSH 

```
é€šé“åªè´Ÿè´£æ¶ˆæ¯çš„ä¼ é€’ï¼Œå¯¹æ¶ˆæ¯ä¸åšä»»ä½•å¤„ç†ï¼Œå½“å®¢æˆ·ç«¯æ¥æ”¶åˆ°é€ä¼ æ¶ˆæ¯åï¼Œç”±å®¢æˆ·ç«¯è‡ªå·±æ¥å†³å®šå¦‚ä½•å¤„ç†æ¶ˆæ¯ã€‚æ­£æ˜¯å› ä¸ºé€ä¼ æ¶ˆæ¯å¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯ä½“ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯çš„å±•ç¤ºæ–¹å¼åŠåç»­åŠ¨ä½œå¤„ç†ï¼Œæ‰€ä»¥å¼¥è¡¥äº†é€šçŸ¥æ æ¶ˆæ¯çš„ä¸€äº›ä¸è¶³ä¹‹å¤„(é€šçŸ¥æ æ¶ˆæ¯æ˜¯ç›´æ¥å±•ç¤ºå‡ºæ¥ï¼Œç›¸å…³çš„åŠ¨ä½œå®¢æˆ·ç«¯æ— æ³•æ•è·åˆ°)ã€‚
```
AppID AppKey clientåˆå§‹åŒ–æ—¶å¿…å¤‡ï¼Œæ ‡è¯†è¿™ä¸ªclientï¼Œä½†ä¸å”¯ä¸€
AppSecret å¼€å‘è€…æœåŠ¡ç«¯çš„èº«ä»½æ ‡è¯†ï¼Œå®¢æˆ·ç«¯æ ¹æ®è¿™ä¸ªæ ¡éªŒå‘æ¥æ•°æ®çš„èº«ä»½ã€‚
MasterSecret è°ƒç”¨APIæ—¶å¿…é¡»çš„èº«ä»½éªŒè¯æ ‡è¯†

RegistrationID åº”ç”¨åœ¨æŸè®¾å¤‡ä¸Šçš„å”¯ä¸€ID
userAccount ç”¨æˆ·ID
ç›®æ ‡æ•° : åˆ›å»ºæ¨é€ä»»åŠ¡æ—¶ï¼Œæäº¤çš„ç”¨æˆ·Registration_IDæ•°
æœ‰æ•ˆæ•° : è¿‡æ»¤æ‰å¤±æ•ˆè®¾å¤‡ï¼Œå¸è½½ï¼Œåˆ·æœºï¼Œä¸‰æœˆå†…æœªè”ç½‘
åˆ°è¾¾æ•°ï¼šæ¶ˆæ¯æˆåŠŸåˆ°è¾¾ç”¨æˆ·æ‰‹æœºä¸Šçš„æ•°é‡
å±•ç¤ºæ•°ï¼šç”¨æˆ·æ‰‹æœºæ”¶åˆ°æ¶ˆæ¯åï¼Œé€šçŸ¥æ å±•ç¤ºæˆåŠŸçš„æ•°é‡
ç‚¹å‡»æ•°ï¼šæ¶ˆæ¯åœ¨ç³»ç»Ÿé€šçŸ¥æ å±•ç¤ºåï¼Œç”¨æˆ·ç‚¹å‡»çš„æ•°é‡

## android sdk ç¼“å­˜åŸç†
- adb root 
- abd shell
- cd /data/data/com.growing.gtouch/cache/gtouch
- ls -al æ ¹æ®æ—¶é—´æŸ¥çœ‹ç¼“å­˜åˆ°æœ¬åœ°çš„MD5å½¢å¼çš„html
- é€‚å½“catä¸€ä¸‹ä¹Ÿå¯ä»¥

è¦æ±‚ï¼šè¯·æ±‚æˆåŠŸè¿‡ä¸€æ¬¡åï¼Œå°±ä¸å†è¯·æ±‚ï¼Œä¸”è¯¥å¼¹å¤šå°‘æ¬¡å°±å¼¹å¤šå°‘æ¬¡ï¼Œä¸å¤šä¸€æ¬¡ä¹Ÿä¸å°‘ä¸€æ¬¡ã€‚

## nginx
å®‰è£…ä¿¡æ¯
```
Docroot is: /usr/local/var/www

The default port has been set in /usr/local/etc/nginx/nginx.conf to 8080 so that
nginx can run without sudo.

nginx will load all files in /usr/local/etc/nginx/servers/.

To have launchd start nginx now and restart at login:
  brew services start nginx
Or, if you don't want/need a background service you can just run:
  nginx
==> Summary
ğŸº  /usr/local/Cellar/nginx/1.17.3_1: 27 files, 2MB
```
## æ¨é€ç›¸å…³
oppo u = fd51fb0e-7ac7-3a2a-bbef-02b5a9002d21
vivo u = eab19098-a90f-3935-b775-820a3257a61b
     u = 8ecf106d-3be6-3851-98a9-d7077f4427e4

åŒä¸ªæ‰‹æœºï¼Œä¸åŒçš„appï¼Œuä¸ä¸€å®šç›¸åŒ
åä¸ºé­…æ—å˜uæ²¡äº‹ï¼Œtokenä¸ä¼šå˜ã€‚
å°ç±³å˜uæœ‰æ—¶ï¼Œtokenä¼šå˜ã€‚

  å†…å®¹é™åˆ¶
```
åä¸ºï¼šåä¸ºå¹³å°æ¨é€æ ‡é¢˜é™åˆ¶40å­—ç¬¦ï¼Œå†…å®¹é™åˆ¶1024å­—ç¬¦ã€‚

å°ç±³ï¼šå°ç±³å¹³å°æ¨é€æ ‡é¢˜é™åˆ¶32å­—ç¬¦ï¼Œå†…å®¹é™åˆ¶128å­—ç¬¦ã€‚

é­…æ—ï¼šé­…æ—å¹³å°æ¨é€æ ‡é¢˜é™åˆ¶32å­—ç¬¦ï¼Œå†…å®¹é™åˆ¶100å­—ç¬¦ã€‚

vivoï¼švivoå¹³å°æ¨é€æ ‡é¢˜é™åˆ¶20å­—ç¬¦ï¼Œå†…å®¹é™åˆ¶50å­—ç¬¦ã€‚

oppoï¼šoppoå¹³å°æ¨é€æ ‡é¢˜é™åˆ¶50å­—ç¬¦ï¼Œå†…å®¹é™åˆ¶50å­—ç¬¦ã€‚
```

## androidå•æµ‹æ¡†æ¶
supportAnnotations = '28.0.0'
supportViewpager = '28.0.0'
mockitoCore = '2.23.0'
powermockApiMockito2 = '2.0.2'
powermockModuleJunit4 = '2.0.2'
orgJson = '2.0'
jacocoAndroid = '0.1.4'
sonarqube = '2.8'
junit = '4.12'
truth = '1.0'
robolectric = '4.3.1'
xTest = '1.2.0'
xTestExt = '1.1.1'

## æ¨é€çš„é€è¾¾ç‡é—®é¢˜
æ¨é€æœ‰é€è¾¾ç‡ä¸ç‚¹å‡»ç‡ä¸¤ä¸ªæŒ‡æ ‡
- å›½å†…å‚å•†é€šé“å¯ä»¥ä¿è¯é€è¾¾ç‡
- è°·æ­Œä¸è‹¹æœå¯ä»¥ä¿è¯é€è¾¾ç‡
- æ¨é€è¦åŠæ—¶ï¼Œä¸€ä¸ªåº”ç”¨é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å…¶æ€æ­»ï¼Œå¯¼è‡´æ— æ³•é€è¾¾ï¼Œé€è¾¾ç‡ä½
- æ¨é€è¦æœ‰è¶£ï¼Œä¸€ä¸ªåº”ç”¨çš„æ¨é€ç»å¸¸ä¸è¢«ç‚¹å‡»ï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šå°†å…¶éšè—æˆ–æŠ˜å è¿™æ®µæ¨é€ï¼Œå¯¼è‡´æœ‰é€è¾¾ï¼Œä½†ç‚¹å‡»ç‡ä½ã€‚


## JQL
```jql
æŸ¥æ‰¾6æœˆä»½ç”±æˆ‘è½¬å‘ç»™åˆ«äººçš„JIRAé—®é¢˜
assignee changed by ç”¨æˆ·å AND created > "2019/06/01" AND created < "2019/06/30" ORDER BY created DESC

æŸ¥æ‰¾æˆ‘æœ€è¿‘åŠå¹´è§£å†³çš„JIRAé—®é¢˜
project = é¡¹ç›®å AND assignee = ç”¨æˆ·å AND created > "2018/06/01" and created < "2018/12/30"

status=resolved AND project=â€œTeams in Spaceâ€ OR assignee=captainjoe

project = HZPI and fixVersion = "v19.19.5(2019-10-29)"

  JQL Fields
https://confluence.atlassian.com/jirasoftwareserver082/advanced-searching-fields-reference-974359687.html
Affected version
Approvals
Assignee
Attachments
Category
Comment
Component
Created
Creator
Custom field
Customer Request Type
Description
Due
Environment
Epic link
Filter
Fix version
Issue key
Issue link type
Labels
Last viewed
Level
Original estimate
Parent
Priority
Project
Remaining estimate
Reporter
Request channel type
Request last activity time
Resolution
Resolved
SLA
Sprint
Status
Summary
Text
Time spent
Type
Updated
Voter
Votes
Watcher
Watchers
Work log author
Work log comment
Work log date
Work ratio
```
## ab_testä¸ab_test_messages 

ab_testæ˜¯å…³ç³»è¡¨ï¼Œmessageså­—æ®µå­˜å‚¨ab_test_messagesé‡Œçš„å®éªŒæ¶ˆæ¯id
```
 {
    "id": "32",
    "project_id": "3",
    "creator_id": "166110",
    "updater_id": "166110",
    "created_at": "17/10/2019 14:42:18.368",
    "updated_at": "17/10/2019 14:42:39.124",
    "state": "stop",
    "messages": "[0:3]={5855,5856,5857,5858}",
    "latest_messages": "[0:1]={5857,5858}",
    "name": "å¼¹çª—20191017224159",
    "ab_dimension": "vstr_gio_ma_abtest_32", -- ma --> "dimension":"vstr_gio_ma_abtest_32"
    "ai": "0a1b4118dd954ec3bcc69da5138bdb96",
    "compare_type": "controlã€materialã€activity"  æ§åˆ¶å‹ABæµ‹ï¼Œç´ æå‹ABæµ‹ æ¨å¹¿å‹ABæµ‹. 
  }, 
```
ab_test_messagesæ˜¯å­—å…¸è¡¨
```
"symbol"--ma--->"A1"
```

metricï¼šè½¬åŒ–ç›®æ ‡

## ABå¼¹çª—åå°é€»è¾‘

æ­£å¸¸ä¸Šçº¿abå¼¹çª—åå°±ä¼šå°†æ•°æ®å†™è¿›ab_test_messagesä¸ab_testï¼Œå†åˆ·æ–°ç¼“å­˜ã€‚

å¦‚æœç¼“å­˜é‡Œæ²¡æœ‰ï¼Œå°±æ ¹æ®aiä¸schemalæ‰¾åˆ°æ‰€æœ‰å¼¹çª—ï¼Œå†æ ¹æ®u/csè¿‡æ»¤segmentã€‚
å¯¹ab_test_messagesè¡¨ä¸­å‘½ä¸­çš„å¼¹çª—æŒ‰æ¯”ä¾‹åˆ†æµã€‚


### abå‘½ä¸­é€»è¾‘

u--ab_test_hash--> bucketIdï¼Œå°†æ‰€æœ‰æ¶ˆæ¯åˆ†é…æˆ100ä¸ªæ¡¶ï¼Œ1-rate*100 æ¡¶é‡Œçš„ä¸ºå®éªŒA


å½“æŸæ¶ˆæ¯çš„rateå¤§äºbucketIdæ—¶ï¼Œå‘½ä¸­æ¶ˆæ¯å°†å…¶isCtrlæ”¹é€ ä¸ºfalse

### ABæµ‹ç›¸å…³æ¥å£

POST    /projects/:projectId/marketing/gtouch/abtest { "messages":[{},{} ]} åˆ›å»ºä¸€å¯¹ABå¼¹çª—

è¿”å›bodyå¤šä¸€ä¸ªdimensionå­—æ®µ

PUT    /projects/:projectId/marketing/gtouch/abtest/:abtestid æ›´æ–°ABå¼¹çª—

GET    /projects/:projectId/marketing/gtouch/abtest/latestMsgs/latestMsgs/:abtestId   è¿›å…¥ç¼–è¾‘é¡µæ—¶è·å–å½“å‰abå¼¹çª—çš„æœ€æ–°ä¸€å¯¹å¼¹çª—

GET    /projects/:projectId/marketing/gtouch/abtest/history/:abtestId   è¯¦æƒ…é¡µè·å–abå¼¹çª—æ‰€æœ‰å†å²æ•°æ®

DELETE    /projects/:projectId/marketing/gtouch/abtest/:abtestId
åˆ é™¤ABæµ‹æ‰€æœ‰å¼¹çª—

POST      /_private/v4/projects/nxog09md/chartdata  è½¬åŒ–ç‡
```
metrics
{
  - id
  - name å¼¹çª—çš„å±•ç¤º
  - type custom
  - attributes å¼¹çª—çš„åç§° id valueType
  - filter è¿‡æ»¤ var_in_app_message_name = æ–‡ç« 2
},{
  - è½¬åŒ–ç›®æ ‡
}
timeRange:""
userType:"usv"          
```

response:"data[0.0]"

## ç§»åŠ¨ç«¯æµ‹é‡åè®®
- page:æ‰“å¼€æ–°é¡µé¢ t:page u p tl cd1 esidï¼šè¯·æ±‚id
- vst:æ–°è®¿é—® u t cs1 fv:{auï¼šæ— åŸ‹ç‚¹ç‰ˆæœ¬ raï¼šRNç‰ˆæœ¬ tvï¼šè§¦è¾¾ç‰ˆæœ¬}
- activate: appé¦–æ¬¡è¯·æ±‚
- reengage: Deeplinkè¯·æ±‚
- clckï¼šç‚¹å‡» u t p e cs1
- imp:å…ƒç´ å±•ç° u t p e cs1
- chng:è¾“å…¥å…ƒç´ æ”¹å˜ u s t p e
- cstm:trackç±»å‹ u s t d !!var num
- pvar:setPageVariable 
- vstr:setVisitor
- evar:setEvar
- ppl:setPeopleVariable

## æ•°æ®åº“

å¼¹çª—ä¸æ¨é€æ˜¯ä¸¤å¥—ã€Œå˜é‡+æŒ‡æ ‡ã€
events.event_variables äº‹ä»¶çº§å˜é‡
events.custom_event åŸ‹ç‚¹äº‹ä»¶
growing.push_metrics è§¦è¾¾äº‹ä»¶çº§å˜é‡


## æŸ¥è¯¢æŸåˆ†ç¾¤çš„csidçš„æ–¹æ³•
æ¦‚è¿°

è§¦è¾¾äº§å“æ ¸å¿ƒä¾èµ–åˆ†ç¾¤ï¼Œä»¥ç™»å½•ç”¨æˆ·åˆ†ç¾¤"GTouchåˆ†ç¾¤â€“æå››"ä¸ºä¾‹ã€‚æ“ä½œç¯å¢ƒæ˜¯ciç¯å¢ƒï¼ŒåŸŸåä»¥k8så¼€å¤´çš„ã€‚

æ­¥éª¤
1 navicat è¿›å…¥qaç¯å¢ƒæ•°æ®æºgrowingåº“user_segmentè¡¨ã€‚æœç´¢ select * from user_segment where name = 'GTouchåˆ†ç¾¤â€“æå››'.æ‹¿åˆ°åˆ†ç¾¤id '85410'ã€‚

2 jumpbox è¿›å…¥è·³è½¬æœºåæ‰§è¡Œ ssh qa-online0 ,è¿›å…¥qa-online0çš„æƒé™éœ€è¦æ‰¾sreç”³è¯·ã€‚è¿›å…¥åé©¬ä¸Šåˆ‡æ¢ç”¨æˆ· sudo su - apps  ã€‚

3 è¿›å…¥phonexç›®å½• cd /apps/phoenix ï¼Œè¿›å…¥åæ‰§è¡Œ./bin/sqlline.py qa-hd0  ã€‚

4 æ‰§è¡Œselect * from SEGMENT where TAG_ID = '85410'. è¡¨ä¸­USERå­—æ®µå°±æ˜¯ã€ŒGTouchåˆ†ç¾¤â€“æå››ã€åˆ†ç¾¤é‡Œæ‰€æœ‰çš„csid .

## å¦‚ä½•ç”¨PostmanæŸ¥è¯¢æ•°æ®ç«¯
åˆ©ç”¨ç«™å†…æ•°æ®ç«¯æ¥å£çš„x-request-id ä¸ http://kibana.infra.growingio.com/

ä»¥æŸ¥è¯¢æŸwebå¼¹çª—çš„ä»Šæ—¥å±•ç¤ºæ¬¡æ•°ä¸ºä¾‹

æ‰¾åˆ°å¯¹åº”chartdataæ¥å£çš„x-request-id

å»kibanaæœç´¢

æ‹¿åˆ°bodyä¸æœåŠ¡å™¨ä¿¡æ¯

é“¾æ¥å†…ç½‘vpnï¼ŒæŸ¥è¯¢urlä¸ºhttp://m6qs4:6060/stat/metric/v2/table?ignoreCache=trueï¼Œé…å¥½Headers




## qsæ¥å£æŸ¥è¯¢

1. åœ¨çº¿ä¸Šæ‹¿åˆ°chatdataæ¥å£çš„requestId
2. å»kibamaæœè¿™ä¸ªidï¼Œæ‹¿åˆ°ç›¸å…³çš„bodyä¸æœåŠ¡å™¨ï¼ˆm6qs4è¿˜æ˜¯å…¶å®ƒï¼‰
3. å»postman è¯·æ±‚http://m6qs4:6060/stat/metric/v2/table?ignoreCache=true æ¥å£



## Web-JS-SDKçš„è‡ªåŠ¨åŒ–
### è‡ªåŠ¨åŒ–
  é…ç½®äº†ä¸€ä¸ªjenkines-jobï¼šhttp://jenkins.infra.growingio.com/view/Release/job/push-sdk-demo-rs/  å°†æµ‹è¯•demoç¼–è¯‘å¥½åæ¨é€åˆ° https://www-release.growingio.com/testpage/index.htmlï¼Œé€šè¿‡åŠå…¬å®¤wifiå³å¯è®¿é—®
### æ”¹è¿›æ€è·¯
  ä»“åº“ ssh://vcs-user@codes.growingio.com/diffusion/281/growing-sdk-web-push.git (push)
  libä¸srcæ˜¯æ‰“åŒ…åçš„ç›®å½•ï¼Œä¸è¦åŠ¨
  binæ˜¯webpackç›®å½•ï¼Œä¸è¦åŠ¨
  confæ˜¯çº¿ä¸Šæ‰“åŒ…ç›®å½•ï¼Œç»å¯¹ä¸èƒ½åŠ¨
  distæ˜¯æ‰“åŒ…ç”Ÿæˆçš„ç›®å½•,dist/1.0/ä¸dist/æ˜¯ç»™çº¿ä¸Šç”¨çš„,dist/javascript/æ˜¯ç»™demoç”¨çš„

### åŸç†
- webé¡¹ç›®çš„index.htmlé‡ŒåµŒå…¥vds-sdkä¸growingio-sdkï¼ŒåŒæ—¶å‘è¿œç¨‹æ‹‰vds.jsä¸access.jsã€‚
- vdså…ˆç”Ÿæˆä¸€ä¸ªpageé¢„å®šä¹‰äº‹ä»¶ï¼Œå¡è¿›EventMessageQueue. access.jsåœ¨ç¬¬ä¸€æ¬¡è·å–åˆ°notificationæ¥å£é‡Œçš„æ•°æ®åä¼šå¡è¿›PushMessageQueneï¼Œå¹¶ä¸»åŠ¨å»æ¶ˆè´¹EventMessageQueueï¼Œå¹¶åŒåŠ è½½render.js.
- render.jsä¸»åŠ¨æ¶ˆè´¹PushMessageQueneã€‚
- åç»­EventMessageQueueé‡Œæœ‰æ–°çš„äº‹ä»¶äº§å‡ºæ—¶ï¼Œaccess.jsè¢«åŠ¨æ¶ˆè´¹ã€‚ä»…é‡åˆ°pageäº‹ä»¶æ‰ä¼šè°ƒç”¨render.jsæ¶ˆè´¹PushMessageQueneã€‚

## arc
arc diff master --preview
arc diff master --update D13595

arc patch D13595
arc land onto master

## æ¨é€
### AppId,AppKey,AppSecret
appIdæ˜¯å”¯ä¸€è´¦æˆ·ç¼–å·ï¼Œå¯ä»¥æ‹¥æœ‰å¤šä¸ªappKeyã€‚
appKeyæ˜¯å…¬é’¥ï¼Œæ˜¯æƒé™é›†åˆï¼Œæè¿°ä½ æœ‰å“ªäº›æƒé™ã€‚
appScrectæ˜¯ç§˜é’¥ï¼Œæ˜¯è¯æ˜ä½ æ˜¯ä½ çš„ä¸€ç§æ‰‹æ®µã€‚
è´¦æˆ·æ‰€åœ¨å¹³å°çš„æœåŠ¡å™¨ä¼šå­˜æœ‰ä½ çš„AppId,AppKey,AppSecretã€‚æ‰€ä»¥å®¢æˆ·ç«¯åªéœ€å‘æœåŠ¡å™¨å‘é€appKeyä¸appScrectå³å¯

æœ€ç»ˆä¼šç”Ÿæˆä¸€ä¸ªaccess_token,ä¿å­˜åˆ°appçš„ç¼“å­˜é‡Œã€‚å…å¾—æ¯æ¬¡éƒ½è¦é‡å¤è¯·æ±‚
è§¦è¾¾æ¨é€ä¼šç»™æ¯ä¸ªåŠ è½½äº†æ¨é€æ¸ é“æ¨¡å—çš„sdkç”Ÿæˆä¸€ä¸ªgio_push_tokenä¾›è§¦è¾¾æœåŠ¡å™¨è°ƒç”¨


## ç›¸å…³å‚æ•°
- é‚€è¯·é“¾æ¥ http://k8s-qa-www.growingio.com/invitations/ac4880bbcf8bdcab
-   """
        ä¸€ è§¦è¾¾å¼¹çª—è„šæœ¬çš„å®Œæ•´ä½¿ç”¨ç¤ºä¾‹ï¼š
        1.1 python popWin_tool_2.7.py
            è¯·è¾“å…¥è„šæœ¬åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºdiffï¼šdiff
            è¯·è¾“å…¥è®¿é—®ç¯å¢ƒï¼Œé»˜è®¤ä¸ºqaï¼šqa
        äºŒ å‚æ•°è®²è§£ï¼š
        2.1 -c:é»˜è®¤ä¸ºâ€™qaâ€˜
        2.1.1 â€™qaâ€˜ å¯¹åº”qaæµ‹è¯•ç¯å¢ƒ
        2.1.2 â€™ciâ€˜ å¯¹åº”ciæµ‹è¯•ç¯å¢ƒ
        2.1.3 â€™onlineâ€˜ å¯¹è±¡çº¿ä¸Šç¯å¢ƒ
        2.2 -f:é»˜è®¤ä¸ºâ€™latestâ€˜
        2.2.1 latest è‡ªåŠ¨è°ƒç”¨æµè§ˆå™¨æ‰“å¼€æœ€æ–°çš„å¼¹çª—H5
        2.2.2 diff ä¸‹è½½æœ€æ–°å¼¹çª—H5å¹¶ä¸æœ¬åœ°å‡†å¤‡å¥½çš„htmlæ–‡ä»¶liåˆ©ç”¨vscodeä½œdiffå¯¹æ¯”ï¼Œéœ€è¦vscodeäº‹å…ˆåœ¨å‘½ä»¤é¢æ¿å†…æ‰§è¡Œâ€™Install â€˜code' command in PATHâ€˜
        2.2.3 dir è‡ªåŠ¨ä¸‹è½½å¯¹åº”äº§å“ï¼Œåˆ†ç¾¤ï¼Œç¯å¢ƒçš„æ‰€æœ‰å¼¹çª—H5
        2.2.4 list åˆ—å‡ºå½“å‰aiä¸growing.schemalçš„æ‰€æœ‰å¼¹çª—
        2.3 -u:é»˜è®¤ä¸ºâ€™growing.638b52710867187câ€˜
        growing.638b52710867187c å¯¹åº”äº§å“â€™GTouch-Androidâ€˜
        2.4 -s:é»˜è®¤ä¸ºâ€™lisiâ€˜
        lisi å¯¹åº”â€™GTouchåˆ†ç¾¤-ç”¨æˆ·æå››â€˜
        ä¸‰ æ³¨æ„äº‹é¡¹ï¼š
        3.1 ä½¿ç”¨è„šæœ¬å‰è¯·å…ˆç¡®è®¤ä½ çš„macèƒ½è®¿é—®çº¿ä¸Šï¼Œqaï¼Œciè¿™ä¸‰ä¸ªç¯å¢ƒ
        3.2 åŒæ—¶ç¡®ä¿ä½ çš„macä¸Šæ²¡æœ‰è¿è¡Œä»£ç†æˆ–æ‹¦æˆªç­‰è½¯ä»¶
        å›› åç»­å¼€å‘ï¼š
        4.1 python2.7ç‰ˆæœ¬ä¼šæ”¹æˆinputå¼å¡«å†™å‚æ•°ï¼Œæ–¹ä¾¿äººå‘˜ä½¿ç”¨
        4.2 è®¡åˆ’å¼•å…¥diffHtmlåº“ä¸çº¿ä¸Šç¨³å®šçš„å¼¹çª—èµ„æºå¯¹æ¯”
        äº” å¸¸ç”¨å‚æ•°:
            frontend-app{'GTouchè§¦è¾¾åˆ—è¡¨é¡µURL':'http://k8s-qa-www.growingio.com/projects/nxog09md/marketing-automation/manage/message/popup-window'}

            GTouch-Android{'id':'q9ApEpoW' ,'urlSchema':'638b52710867187c' ,'spn':'com.growingio.gtouch'}
            GTouch-IOS{'id':'L9GVzZo6' ,'urlSchema':'0e06d947ebba35b7' ,'spn':'com.growingio.TouchDemo'}
            ç”µå•†demo-iOS{'id':'xogdzD9m' ,'urlSchema':'9683a369c615f77d' ,'spn':'com.gio.growingiodemo'}
            
            GrowingIO{'id':'nxog09md',ai':'0a1b4118dd954ec3bcc69da5138bdb96','projectId':'3','orgnazationId':'2'}
            ç”µå•†Demo{'id':'z98jGyZP',ai':'97fd6815651f25fb','projectId':'112439','orgnazationId':'2'}
            Mina Growth{'ai':'9c76fe4756c3404d','projectId':'81624','orgnazationId':'2'}
            Minappå¼¹çª—æµ‹è¯•Demo remote='codes.growingio.com/source/marketing-push-minp-demo.git',name='å¼¹çª—Test',productId='xRxzpbo5',platform='minp',spn='wx0686f7c349efef47',urlSchema='wx0686f7c349efef47',ç›´æ¥æœ¬åœ°è°ƒè¯•+çº¿ä¸Šwang'g
            pushæ³¨å†Œ http://k8s-qa-www.growingio.com/oauth2/qrcode_token/b5772a277567df4b3e83367042b6cb41677952ecfd7f5afd34a0b07e3acc0a33?circleRoomNumber=JK2lqZHF2SXscYoV&campaignGroup=gTouch&userId=a9BL8qwP&productId=xogdzD9m&gtouchType=preview&messageId=GQPD1yoN
            ç™»å½•ç”¨æˆ·ID æå››çš„bu=553306ï¼Œbcs=137554
            è®¿é—®ç”¨æˆ·ID vivoZ3çš„u=deviceId='eab19098-a90f-3935-b775-820a3257a61b'
            äº§å“ GTouch-Test-Androidçš„productId='bR78krPG',spn='com.growingio.gtouchtest',urlSchema='c3240a35f1c2c394'

            æ¶ˆæ¯å…³é—­äº‹ä»¶ "messageClose": "4PKyZJ9E",
            æ¶ˆæ¯å±•ç¤ºäº‹ä»¶ "messageImp": "GPnlGO9Y",
            æ¶ˆæ¯ç‚¹å‡»äº‹ä»¶ "ctaMetrics": "EoZ7Ge9k"
            
            é»„æ—¥è¶…çš„GTouchå°ç¨‹åº secret c749426df9d54ebe16687d595e5970b2
                        appId  wxd4626ea0768f555b

        """

## GQL Charts Service
### Query
![](https://tva1.sinaimg.cn/large/006y8mN6ly1g6hogs7lxij30l60pat97.jpg)

*æ¼æ–—* type = funnelæ¼æ–—/retentionç•™å­˜
*å¤§æ•°å­—å›¾ã€æ¼æ–—* aggregation = æ˜¯å¦åªåšèšåˆè¿ç®—ï¼šboolean 
*å¤§æ•°å­—å›¾* aggregator = èšåˆç®—æ³•ï¼šsum,avg,min,max

*æŒ‡æ ‡* metrics = id=æŒ‡æ ‡id,level=action/complex
*æ¼æ–—ï¼Œè½¬åŒ–ç‡* å˜åŒ–ç‡ã€è½¬åŒ–å‘¨æœŸ attrs = rateChange:true

*èšåˆ* level = complexèšåˆ/dashæ‰“ç‚¹/simpleç®€å•/originalæŒ‡æ ‡/gelè¡¨è¾¾å¼/expressionå…¨å±€id

dimensions = "tm","region","countryName"ç­‰
granularities = {id=tm,interval=8640000},{id=countryName,top=10}

*å±•å¼€* expanded = æŒ‰æœ€åä¸€ä¸ªç»´åº¦å±•å¼€

*ç»´åº¦ç»„åˆä¸Šé™* limit :å¤šç»´åº¦ç»„åˆçš„ç»„åˆä¸Šé™

*è¿‡æ»¤* filter ={
    "op": "=",
    "key": "b",
    "value": "Web", 
    "name": "ç½‘ç«™/æ‰‹æœºåº”ç”¨"
}
timeRange:String = "day:8,1" ,"abs:11510000:1161000","dur:151000+3000"æŸå¤©å¼€å§‹ï¼Œ5åˆ†é’Ÿç²’åº¦ï¼Œ"week:2,1","month:2,1","year:2,1","date:20180101,20180130" ,"year:prevä¸Šä¸€å¹´"

userTag:String = "" åº”ç”¨åˆ†ç¾¤
orders = æ’åºåºåˆ—ï¼šList<Order>



### Result
![](https://tva1.sinaimg.cn/large/006y8mN6gy1g6hrvn1ac7j30py1g60tw.jpg)
data ï¼šdimensionsæ‰€æœ‰ç»´åº¦çš„å€¼ + metricsé‡Œæ‰€æœ‰æŒ‡æ ‡çš„å€¼
meta = columns+ aggregator 
column = idæŒ‡æ ‡ç»´åº¦+ nameæŒ‡æ ‡ç»´åº¦+ isDimæ˜¯å¦ç¶­åº¦+ isRateæ˜¯å¦æ¯”ç‡


## è§¦è¾¾å¸¸ç”¨query
``` 
æ¼æ–— - è¶‹åŠ¿
{
  "type": "funnel",
  "aggregation": false,
  "metrics": [
    {
      "id": "woV7nW92",
      "action": "page",
      "level": "original"
    },
    {
      "id": "4PYbJ1go",
      "action": "clck",
      "level": "original"
    }
  ],
  "dimensions": [
    "tm",
    "rd"
  ],
  "granularities": [
    {
      "id": "rd",
      "values": [
        "link.zhihu.com",
        "www.baidu.com"
      ]
    }
  ],
  "timeRange": "abs:1516982400000,1517327999999",
  "attrs": {
    "conversionWindow": 1,
    "userType": "uv"
  }
}
```

```
æ¼æ–—--è½¬åŒ–ç‡
{
  "type": "funnel",
  "aggregation": true,
  "timeRange": "day:15,1",
  "attrs": {
    "conversionWindow": 1
  },
  "metrics": [
    {
      "id": "woV7nW92",
      "level": "original",
      "action": "page"
    },
    {
      "id": "4PYbJ1go",
      "level": "original",
      "action": "clck"
    }
  ]
}

```

```
å¤§æ•°å­—å›¾
{
  "aggregation": true,
  "aggregator": "sum",
  "dimensions": [
    "tm"
  ],
  "granularities": [
    {
      "id": "tm",
      "interval": 86400000
    }
  ],
  "metrics": [
    {
      "level": "complex",
      "id": "9yGbpp8x"
    }
  ],
  "timeRange": "day:8,1"
}
```

## GTouch Android Banner

### messagesæ¥å£è¯·æ±‚çš„å‘èµ·
http.HttpClient
- HttpRequest.getè¯·æ±‚ 
- UrlCongif.host() + "v2" + CertificationUtil.getProjectId() + "notification"
  - CertificationUtil.getProjectId()
### CoreInitialize SDKæ ¸å¿ƒåŠŸèƒ½
    - getSPN
    - getProjectId
    - getNetworkStateName
    - getForegroundActivity
    - getResumedActivity
    - getCurrentRootWindowsHashCode
  - CoreInitialize.gConfig()
    - getAppUserId
    - getGrowingScheme
  - CoreInitialize.deviceUUIDFactory()
    - getDeviceId
    - getDeviceImei
    - getAndroidId
    - getIMEI
    - getUUID
    - getOldDeviceId
  - CoreInitialize.messageProcessor()
  - CoreInitialize.growingIOIPC()
    - getRunningProcess
    - getAlivePid
    - getGioUserId
    - getToken
    - getWsServerUrl
    - getSpecialModel
    - getSessionId
    - getUserId
    - getAppVar
    - getLastResumeTime
    - getLastPauseTime
  - CoreInitialize.deeplinkManager()

### DataHelper GTouch SDkæ ¸å¿ƒç¼“å­˜æœºåˆ¶

### TouchDatabase GTouchç¼“å­˜åŠŸèƒ½
"TAG":"TouchDatabase"
- db_name:GrowingioTouch.db
- table:gtouch
- columns:
  - event_id
  - show_count
  - show_timestamp
  - is_click
  - user_id
- æ—§ç‰ˆçš„gtouchè¡¨versionä¸º1ï¼Œæ²¡æœ‰ show_timestamp è¿™ä¸ªå­—æ®µ
- æ–°ç‰ˆçš„gtouchè¡¨versionä¸º2ï¼Œå¤šäº†ä¸€ä¸ª show_timestamp å­—æ®µ
- queryPopupEventState(eventId) æ ¹æ®äº‹ä»¶keyä¸UserIdæ‰¾åˆ°å¯¹åº”çš„è§¦å‘è®°å½•
- saveClickedEvent(enevtId) å…ˆç”Ÿæˆä¸€ä¸ªè¡Œè®°å½•ContentValues cv.put(K,V)çš„å½¢å¼ç”Ÿæˆå­—æ®µä¸å¯¹åº”çš„æ•°æ®ã€‚is_clickï¼š1ï¼Œuser_idï¼šuserId.æœ€åè°ƒç”¨db.insert(table,null,cv)å®ç°æ’å…¥æ•°æ®
- addShowedEvent(eventId) eventId,showCuont,showTimeStamp,userIdå››å…ƒç»„ é»˜è®¤-1ï¼Œå¼¹è¿‡ä¸€æ¬¡å°±æ˜¯1
### èµ„æºä½æ¨¡æ¿ BannerData
åºåˆ—åŒ–DOå¯¹è±¡
- name
- bannerKey
- List<BannerItemData> itemss

### banneræ ¸å¿ƒæ¨¡æ¿ä¸åŠŸèƒ½å®šä¹‰ BannerItemData
- mIsFirstBind = false 
- Index å‘ä½å·
- Title
- ImageUrl
- TargetUrl
å®šä¹‰ç‚¹å‡»ç›‘å¬æ–¹æ³• bindItemDataToClickView(),ç‚¹å‡»åè°ƒç”¨TouchMessageDispatcher.postBannerItemEvent()æ–¹æ³•å€ŸåŠ©HttpClient.uploadEventImmediately()ä¸ŠæŠ¥åŸ‹ç‚¹äº‹ä»¶ï¼ŒTag:TouchMessageDispatcher

### BaseBanner åŸºç¡€æ¨¡æ¿
- initDefaultAttrsï¼ˆï¼‰
- initCustomAttrsï¼ˆï¼‰
- initViewï¼ˆï¼‰ åºåˆ—åœ†ç‚¹
- showPlaceholder
- setPageChangeDurationï¼ˆï¼‰é¡µé¢åˆ‡æ¢æ—¶é•¿
- setAutoPlayAbleï¼ˆï¼‰è‡ªåŠ¨åˆ‡æ¢ åœ¨setDataå‰
- setData(List<View> views, List models, List<String> tips)
- setData(@LayoutRes int layoutResId, List models, List<String> tips) 
- setData(List models, List<String> tips)
- setData(List<View> views)
- setData( LocalImageSize localImageSize,  ImageView.ScaleType scaleType,  int... resIds)  720ï¼Œ1280ï¼Œ320ï¼Œ640
- setAllowUserScrollableï¼ˆï¼‰å…è®¸ç”¨æˆ·æ‰‹æŒ‡æ»‘åŠ¨
### banneræ»‘åŠ¨è§†å›¾
- mDuration
- startScroll(x,y,dx,dy)
- startScroll(x,y,dx,dy,duration)

### banneræ ¸å¿ƒå¤„ç†é€»è¾‘ TouchMessageDispatcher
Tag:TouchMessageDispatcher
äº‹ä»¶:gio_touch_bannerItem_clicked && gio_touch_bannerItem_showed
è¯·æ±‚ï¼špostBannerItemEvent(eventType,itemData)
äº‹ä»¶ç±»å‹ï¼šç±»å†…æšä¸¾
```
@StringDef({EVENT_TOUCH_BANNERITEM_CLICKED, EVENT_TOUCH_BANNERITEM_SHOWED})
@Retention(RetentionPolicy.SOURCE)
public @interface EventType {}
```
postBannerItemEvent(event.setKey(eventType).setValue(itemJson),DataCallback),ä¸ŠæŠ¥å¤±è´¥çš„è¯ï¼Œä¸»åŠ¨trackä¸€ä¸‹ï¼Œå­˜åˆ°æœ¬åœ°ã€‚æ‰€ä»¥æœ€å¿«ç«‹é©¬ä¸ŠæŠ¥ï¼Œæœ€è¿Ÿ30ç§’ä¸ŠæŠ¥ã€‚

## ç”¨æˆ·æ¨é€ä»¤ç‰Œæ›´æ–°æ—¶é—´
- æ˜¨æ—¥æ¨é€æ•°æ®ä»¤ç‰Œæ•°æ®æ›´æ–°ä»1å°æ—¶, å®æ—¶ä¸ºäº†3åˆ†é’Ÿ.
- åˆ‡æ¢è®¾å¤‡, åˆ†ç¾¤å†…ç”¨æˆ·å¦‚æœå­˜åœ¨åˆ‡æ¢è®¾å¤‡,,3åˆ†é’Ÿåä¸Šçº¿çš„æ¨é€å‡å¯é€è¾¾æ–°è®¾å¤‡.
- åŒºåˆ†å¹³å°, åŒä¸€ç™»å½•ç”¨æˆ·idå¦‚æœç™»å½•webæˆ–è€…å°ç¨‹åºä¸ä¼šå†å½±å“æ¨é€.

## æµ‹reegnageäº‹ä»¶çš„æ–¹æ³•
- å»ºæ·±åº¦é“¾æ¥ï¼Œå°†é“¾æ¥è´´åˆ°çŸ­ä¿¡æˆ–ä¾¿ç­¾é‡Œ
- anyproxyæŠ“åŒ…
- é€šè¿‡é“¾æ¥å”¤é†’app
- çœ‹æ•°æ®


## å²—ä½åˆ†å·¥
- æŠ€æœ¯æ”¯æŒï¼šå»å®¢æˆ·é¡¹ç›®é‡Œç¡®è®¤é—®é¢˜å¹¶æŒ–æ˜æ›´è¯¦ç»†çš„ä¿¡æ¯
- æµ‹è¯•äººå‘˜ï¼šæ ¹æ®æƒ…å†µå¤ç°é—®é¢˜ï¼Œé€é¡¹æ’æŸ¥æµ‹è¯•æµç¨‹
- å¼€å‘äººå‘˜ï¼šæ ¹æ®æµ‹è¯•äººå‘˜æŠ¥çš„ç°è±¡ä¸å¯èƒ½åŸå› åˆ†æä»£ç ä¸é…ç½®ï¼Œä¿®å¤é—®é¢˜ã€‚


## kibanaä½¿ç”¨æ–¹æ³•
æŸ¥æŸä¸ªæœåŠ¡çš„ERRORæ—¥å¿— æœç´¢ level:ERROR æ·»åŠ filter 
![](2020-04-24-10-30-45.png)

æŸ¥æŸç±»å‹é”™è¯¯ æœç´¢ "java.lang.ArrayIndexOutOfBoundsException: -1"


### æŸ¥çœ‹å®˜ç½‘å‘ç‰ˆæ—¶é—´
- window.__tag

### æŸ¥çœ‹access.js ç‰ˆæœ¬
- gio_plugin_gtouch.version



## ç”µå•†demoå›å½’
- å†…éƒ¨é¡µ com.growingio.giodemo.ProductDetailActivity?product=å¢é•¿é»‘å®¢æ‰‹å†Œ&evar=é™æ—¶ç§’æ€
## æ¨é€
- åä¸ºå›è°ƒåœ°å€ https://messages.growingio.com/v1/callback/huawei
- è¯ä¹¦åœ°å€ https://growingio.atlassian.net/wiki/spaces/MP/pages/964558953 


## å„ä¸ªå‚å•†çš„token
- channel = Huawei, pushToken = 0868403036913330300004885200CN01
- channel = Oppo, pushToken = CN_1eb5f43fd922e6260ac29e992010ae95
- channel = Vivo, pushToken = 15724355870131603348382
- channel = Meizu, pushToken = Z9K487e04780b707d637c5f4269490c5c094279027d01
- channel = Xiaomi, pushToken = 2op09OCEhmO+rJFAzFxpjiX3Xv1vabx3fXRFXpssZ8jhvO+eVOdYH2NCk5gT9NwB

## å‘é€æˆåŠŸï¼Œä½†æ˜¯æ¨é€é€šçŸ¥æ çœ‹ä¸åˆ°æ¨é€çš„åŸå› 

- åˆ†ç¾¤é‡Œæœ‰äººæ•°ï¼Œä½†æ˜¯è¯¦æƒ…é¡µã€Œæ¨é€æƒé™æ‰“å¼€è®¾ç½®äººæ•°ã€ä¸º0ï¼Œæ­¤æ—¶push_messagesæœ‰è®°å½•ï¼Œä½†push_tasksé‡Œä¸ä¼šæœ‰è®°å½•
- å°ç±³æ‰‹æœºçš„é€šçŸ¥æ æ¶ˆæ¯æ˜¯å±•ç¤ºæœ€æ–°çš„ä¸€æ¡ï¼Œå¦‚æœæ¯æ¡éƒ½è¦å±•ç¤ºï¼Œéœ€è¦è®¾ç½® n_idã€‚
- æ¶ˆæ¯å¹¿æ’­è¢«æ‰‹æœºç®¡å®¶å±è”½ã€‚
- é­…æ—æ‰‹æœºæœ‰ä¸€ä¸ªæ¶ˆæ¯ç›’å­ï¼Œä¸€äº›ä¸å¸¸ç”¨çš„æ¶ˆæ¯ä¼šç›´æ¥è¿›å…¥åˆ°æ¶ˆæ¯ç›’å­ä¸­ï¼Œè¯·åœ¨æ¶ˆæ¯ç›’å­ä¸­æŸ¥çœ‹ã€‚
- 
## Androidé”™è¯¯æ—¥å¿—é‡‡é›†
- sentryåœ¨testmodeçš„æ¨¡å¼ä¸‹ä¼šåˆå§‹åŒ–å¤±è´¥
```java
// GTouchManager
if (!BuildConfig.DEBUG && mTouchConfig.isUploadExcweptionEnable()) {
            initMonitor(mContext);
        }
```


## ç”¨æˆ·æœªä¸ŠæŠ¥tokenä¿¡æ¯
- æœªä¸ŠæŠ¥vsträº‹ä»¶
  - å¯èƒ½æ˜¯ æ²¡æœ‰è§¦å‘setUeseId,setPeopleVariable,setSessioId
  - å¯èƒ½æ˜¯ æ¨é€å‚å•†æ³¨å†Œå¤±è´¥ï¼Œæœªè§¦å‘vsträº‹ä»¶
  - æœ€ç»ˆå¯¼è‡´ç”¨æˆ·æœªä¸ŠæŠ¥tokenä¿¡æ¯ã€‘ã€‘ã€‘ã€‘

## æ¨é€è®¾å¤‡æ³¨å†Œå¤±è´¥
- setPushEnable(false)
- äºŒç»´ç è¿‡æœŸ
- sdkåˆå§‹åŒ–æ—¶setPushEnable(false)ä¸”å¯åŠ¨appæœªæ‰§è¡Œè¿‡regester()
- setMessageHost()æ˜¯httpsçº¿ä¸Šç¯å¢ƒ
- æœªå¼€é€šç›¸åº”å‚å•†é€šé“ï¼Œåªå¼€äº†å°ç±³é€šé“æ‹¿oppoæ‰‹æœºå»æ‰«æ˜¯ä¼šå¤±è´¥çš„ã€‚


## é€åˆ°ç‡ä½çš„åŸå› 
- ç”¨æˆ·çš„ç”¨æˆ·æ‰‹æœºè™½ç„¶è£…äº†sdkï¼Œä½†æ˜¯push_tokenå¹¶æœªä¸ŠæŠ¥ã€‚
- GrowingIOä½¿ç”¨çš„æ˜¯gio_push_tokenè¿™ä¸ªè®¿é—®ç”¨æˆ·å˜é‡ï¼Œå†…å®¹æ˜¯æ¯ä¸ªè®¿é—®ç”¨æˆ·uå¯¹åº”çš„å‚å•†é€šé“ç»™å‡ºçš„regester_id.
å¤§éƒ¨åˆ†å‚å•†ï¼Œåªè¦ä½ å¸è½½é‡è£…app regester_idéƒ½ä¼šå˜ã€‚vivoåªè¦ä½ æ‰§è¡Œunregisted()ï¼Œregester_idéƒ½ä¼šå˜ã€‚
- å‡è®¾1ä¸ªåˆ†ç¾¤é‡Œåªæœ‰10ä¸ªç”¨æˆ·ï¼Œä»–ä»¬åå¤å¸è½½å®‰è£…æ€»å…±äº§ç”Ÿäº†100ä¸ªregester_idã€‚å“ªæ€•è§¦è¾¾è¿™è¾¹100%é€è¾¾äº†åˆ†ç¾¤é‡Œçš„æ¯ä¸€ä¸ªäººï¼Œå‚å•†é€šé“ç»™å‡ºçš„é€è¾¾ç‡ä¹Ÿä¼šåªæœ‰10%
- å¦‚æœä½ çš„åˆ†ç¾¤ä½¿ç”¨äº† æ¨é€ä»¤ç‰Œ != ''çš„æ¡ä»¶ï¼Œå¾ˆæœ‰å¯èƒ½å‘ç”Ÿå½“æ— æ•ˆtokenè¶Šæ¥è¶Šä½ï¼Œåˆ†ç¾¤äººæ•°ä¹Ÿä¼šè·Ÿç€è¶Šæ¥è¶Šå¤šçš„æƒ…å†µã€‚

## æ— æ³•å¼¹çª—
- æ˜¯AppOpençš„å¼¹çª—çš„è¯ï¼Œå¯èƒ½æ–­ç½‘
- ä¸æ˜¯AppOpençš„å¼¹çª—ï¼Œå¯èƒ½æ˜¯æ²¡trackäº‹ä»¶ã€‚è¦ä¹ˆç”¨æˆ·è‡ªå·±çš„ä»£ç é‡Œæ²¡trackï¼Œè¦ä¹ˆç”¨æˆ·ä½¿ç”¨æœ‰é—®é¢˜æ²¡è§¦å‘è¿‡äº‹ä»¶ã€‚

## è¿è¥å¹³å°é—®é¢˜
- è¿è¥å¹³å°é—´æ­‡æ€§æ¥å£è¿”å› 404ã€‚çº¿ä¸Šconsuleæ³¨å†ŒæœåŠ¡å°‘äº†ä¸€ä¸ªgrowing-marketing.å¯¼è‡´consuleå»æ¸²æŸ“nginxæ—¶æ²¡æœ‰ç›¸å…³é…ç½®ï¼Œnginxæ‰¾ä¸åˆ°è·¯ç”±å°±ä¼šæŠ¥404


## Android SDK
- è¿˜åœ¨å¿«é€Ÿè¿­ä»£ï¼Œæš‚æ—¶æ²¡æœ‰ç¨³å®šç‰ˆã€‚ç¨³å®šç‰ˆçš„å®šä¹‰è¦æ±‚ï¼šè¿ç»­ä¸ƒå¤©æ—¥æ´»100ä¸‡ä»¥ä¸ºä¸”æ— é‡å¤§é—®é¢˜çš„SDKç‰ˆæœ¬ã€‚


### åå°é¡µé¢æ•°æ®æŸ¥è¯¢å¼‚å¸¸
ç¦»çº¿æœ‰æ•°æ®ï¼Œå®æ—¶æ— æ•°æ®
- m6qs1:6060/stat/metric/v2/line?ignoreCache=falseå¸¦ä¸Šbody
- æ•°æ®åº“ select * from realtime_dimensions where ai = 'ai' and event_id = '69058';
- çœ‹dimension,dimension_value(å¼¹çª—å)ä¸,event_idå¯¹åº”çš„ref_cnt.
- å¦‚æœè¡¨é‡Œæ²¡æœ‰è¿™æ¡è®°å½•ï¼Œåˆ™æ— æ³•æŸ¥è¯¢å®æ—¶æ•°æ®ã€‚

ä¸çŸ¥é“event_idæ—¶çš„sql

select * from realtime_dimensions where ai='0a1b4118dd954ec3bcc69da5138bdb96' and dim_type='var' and 
dimension like '%message_name%' and dimension_value='æ–‡ç« 3_KPI åˆ†æ'

### åˆ›å»ºç¬¬ä¸€æ¡å¼¹çª—å‡ºé”™
åŒç†ç¬¬ä¸€æ¬¡è¯·æ±‚messagesæ¥å£å‡ºé”™

- ç³»ç»Ÿåˆ›å»ºçš„åŸ‹ç‚¹äº‹ä»¶æ²¡æœ‰åœ¨push_metricsè¡¨é‡Œæ’å…¥è®°å½•.åˆ›å»ºå¼¹çª—æ—¶ç»§ç»­å‘eventsåº“é‡Œçš„custom_eventè¡¨æ’å…¥è®°å½•å¯¼è‡´æŠ¥é”™.

### è¯·æ±‚H5èµ„æºå¼‚å¸¸
HTMLæ–‡ä»¶è¯·æ±‚ä¸‹æ¥é200æ—¶ä¹Ÿæ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæ­¤æ—¶éœ€è¦å¯¹å…¶æ©ç›–ï¼Œä¸èƒ½å±•ç¤ºå‡ºæ¥ã€‚

## åœˆé€‰æœ‰ä¸ŠæŠ¥ï¼ŒåŸ‹ç‚¹æ— ä¸ŠæŠ¥
- é€šè¿‡åˆ†ç¾¤ç”¨æˆ·ç»†æŸ¥ï¼Œè·å–ç”¨æˆ·ç™»å½•ID
- å†é€šè¿‡zeppelinæŸ¥æ•°ï¼Œè·å–è¯¥åœˆé€‰å…ƒç´ çš„xpath
- å¯¹æ¯”å‘ç°xpathå’Œæ•°æ®ä¸­å¿ƒåœˆé€‰çš„xpathä¸ä¸€è‡´å¯¼è‡´ã€‚è¯¥äº§å“æ˜¯æµ·å¤–äº§å“ï¼Œç”¨æˆ·æœºå‹å¤§éƒ¨åˆ†æ˜¯æµ·å¤–æœºå‹ã€‚å·²ç»™ç”¨æˆ·è§£é‡Šã€‚


## æŸ¥çœ‹çº¿ä¸Šæ•°æ®
- describe gio.visit
- ä½¿ç”¨äº†è§¦è¾¾1.3.0çš„ç”¨æˆ·æ•°  `select count(*) as num,ai from gio.visit  where time between 202004011600 and 202004071600 and b='Android' and fv like '%1.3.0%' group by ai` 
- ç»Ÿè®¡è§¦è¾¾ç¨³å®šç‰ˆ  `select count(*) as num,fv,b
from gio.visit
where time >= 202004021600 and time <= 202004081600 and b='Android' and fv != null  group by fv,b order by num desc`
- ç»Ÿè®¡åŸ‹ç‚¹ç¨³å®šç‰ˆ `select count(*) as num,fv,b
from gio.visit
where time >= 202004021600 and time <= 202004081600 and b='Android' and av is not null  group by av,b order by num desc`
- ç»Ÿè®¡æŸå¼¹çª—çš„ä¸ŠæŠ¥æ•°æ® `select * from gio.custom_event where time between 202004061600 and 202004071600 and es_map['in_app_message_name'] = '1ä½3å·' and n = 'in_app_message_imp' limit 10`
- ç»Ÿè®¡ä¸åŒuä¸ŠæŠ¥çš„æ¬¡æ•° `select count(*) from (select count(1) from gio.custom_event where time between 202004051600 and 202004061600 and es_map['in_app_message_name'] = 'ä¸€è½¦ä¸€ä»¶ä½¿ç”¨æ•™å­¦' and n = 'in_app_message_imp' and u is not null group by u)`



## æŸ¥çœ‹qaä¸ŠæŠ¥æ•°æ®
1. ç™»å½•è·³æ¿æœºå™¨
1. è·³è½¬ ssh qa-api0
2. åˆ‡æ¢æœºå™¨ï¼šsudo su - apps
3. è¿›å…¥ç›®å½•ï¼š/apps/vds-api/current/logs/event
tail äº‹ä»¶æ—¥å¿— | grep

grep releas11demo ./* d

hiveçš„åˆ°è¿™é‡Œå»æŸ¥ï¼šhttp://qa-online0:8989/#/
æ—¶é—´å¯¹åº”çš„è¡¨éƒ½åœ¨gioåº“

https://codes.growingio.com/w/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%96%87%E6%A1%A3%E9%A6%96%E9%A1%B5/%E8%A7%A6%E8%BE%BE%E8%AF%B4%E6%98%8E/%E8%A7%A6%E8%BE%BE%E6%95%B0%E6%8D%AE%E7%AB%AF%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/

çº¿ä¸Šè§¦è¾¾qsï¼šhttp://internal-query-touch-2022208046.cn-north-1.elb.amazonaws.com.cn:6060/stat/segment/checkUser
çº¿ä¸Šå…¬å…±qs:http://m6qs1:6060
æµ‹è¯•ç¯å¢ƒqs:http://10.1.1.62:6060ã€http://10.1.1.62:6067ã€http://10.1.1.62:6068
## Androidé”™è¯¯æ—¥å¿—é‡‡é›†
- sentryåœ¨testmodeçš„æ¨¡å¼ä¸‹ä¼šåˆå§‹åŒ–å¤±è´¥
```java
// GTouchManager
if (!BuildConfig.DEBUG && mTouchConfig.isUploadExceptionEnable()) {
            initMonitor(mContext);
        }
```


## æ¨é€è®¾å¤‡æ³¨å†Œå¤±è´¥
- äºŒç»´ç è¿‡æœŸ
- sdkåˆå§‹åŒ–æ—¶setPushEnable(false)ä¸”å¯åŠ¨appæœªæ‰§è¡Œè¿‡regester()
- setMessageHost()æ˜¯httpsçº¿ä¸Šç¯å¢ƒ
- æœªå¼€é€šç›¸åº”å‚å•†é€šé“ï¼Œåªå¼€äº†å°ç±³é€šé“æ‹¿oppoæ‰‹æœºå»æ‰«æ˜¯ä¼šå¤±è´¥çš„ã€‚


## é€åˆ°ç‡ä½çš„åŸå› 
- GrowingIOä½¿ç”¨çš„æ˜¯gio_push_tokenè¿™ä¸ªè®¿é—®ç”¨æˆ·å˜é‡ï¼Œå†…å®¹æ˜¯æ¯ä¸ªè®¿é—®ç”¨æˆ·uå¯¹åº”çš„å‚å•†é€šé“ç»™å‡ºçš„regester_id.
å¤§éƒ¨åˆ†å‚å•†ï¼Œåªè¦ä½ å¸è½½é‡è£…app regester_idéƒ½ä¼šå˜ã€‚vivoåªè¦ä½ æ‰§è¡Œunregisted()ï¼Œregester_idéƒ½ä¼šå˜ã€‚
- å‡è®¾1ä¸ªåˆ†ç¾¤é‡Œåªæœ‰10ä¸ªç”¨æˆ·ï¼Œä»–ä»¬åå¤å¸è½½å®‰è£…æ€»å…±äº§ç”Ÿäº†100ä¸ªregester_idã€‚å“ªæ€•è§¦è¾¾è¿™è¾¹100%é€è¾¾äº†åˆ†ç¾¤é‡Œçš„æ¯ä¸€ä¸ªäººï¼Œå‚å•†é€šé“ç»™å‡ºçš„é€è¾¾ç‡ä¹Ÿä¼šåªæœ‰10%
- å¦‚æœä½ çš„åˆ†ç¾¤ä½¿ç”¨äº† æ¨é€ä»¤ç‰Œ != ''çš„æ¡ä»¶ï¼Œå¾ˆæœ‰å¯èƒ½å‘ç”Ÿå½“æ— æ•ˆtokenè¶Šæ¥è¶Šä½ï¼Œåˆ†ç¾¤äººæ•°ä¹Ÿä¼šè·Ÿç€è¶Šæ¥è¶Šå¤šçš„æƒ…å†µã€‚

## æ— æ³•å¼¹çª—
- æ˜¯AppOpençš„å¼¹çª—çš„è¯ï¼Œå¯èƒ½æ–­ç½‘
- ä¸æ˜¯AppOpençš„å¼¹çª—ï¼Œå¯èƒ½æ˜¯æ²¡trackäº‹ä»¶ã€‚è¦ä¹ˆç”¨æˆ·è‡ªå·±çš„ä»£ç é‡Œæ²¡trackï¼Œè¦ä¹ˆç”¨æˆ·ä½¿ç”¨æœ‰é—®é¢˜æ²¡è§¦å‘è¿‡äº‹ä»¶ã€‚

## è¿è¥å¹³å°é—®é¢˜
- è¿è¥å¹³å°é—´æ­‡æ€§æ¥å£è¿”å› 404ã€‚çº¿ä¸Šconsuleæ³¨å†ŒæœåŠ¡å°‘äº†ä¸€ä¸ªgrowing-marketing.å¯¼è‡´consuleå»æ¸²æŸ“nginxæ—¶æ²¡æœ‰ç›¸å…³é…ç½®ï¼Œnginxæ‰¾ä¸åˆ°è·¯ç”±å°±ä¼šæŠ¥404


## Android SDK
- è¿˜åœ¨å¿«é€Ÿè¿­ä»£ï¼Œæš‚æ—¶æ²¡æœ‰ç¨³å®šç‰ˆã€‚ç¨³å®šç‰ˆçš„å®šä¹‰è¦æ±‚ï¼šè¿ç»­ä¸ƒå¤©æ—¥æ´»100ä¸‡ä»¥ä¸ºä¸”æ— é‡å¤§é—®é¢˜çš„SDKç‰ˆæœ¬ã€‚


## cdp web demo
å‘å¸ƒjob
```
#!/usr/bin/env groovy


node {
  def remote = [:]
  remote.name = 'qa0'
  remote.host = 'qa0'
  remote.user = 'apps'
  remote.allowAnyHosts = true
  remote.identityFile="$home/.ssh/id_rsa"
  ansiColor('xterm') {
  stage("clone") {
    deleteDir()
    git branch: env.GIT_BRANCH, url: "ssh://vcs-user@codes.growingio.com/diffusion/281/growing-sdk-web-push.git"

    diffs = DIFFS.trim().toUpperCase().split("(\\s+|\\s*,\\s*)")
    withCredentials([string(credentialsId: 'jenkins-phabricator-conduit-token', variable: 'CONDUIT_TOKEN')]){
        for (i = 0; i < diffs.length; i++) {
          id = diffs[i];
          if (id.trim().length() > 0) {
            sh """arc patch ${id} --conduit-uri ${CONDUIT_URI} --conduit-token=${CONDUIT_TOKEN}"""
            sh "git checkout ${GIT_BRANCH}"
            sh "git merge arcpatch-${id}"
          }
        }
    }
  }
    stage("build") {
        sh "node -v"
        sh "npm cache clean --force && npm install && node bin/build.js  -h='test-browser.growingio.com/webpush' -d='messages.growingio.com' -vs  && cp -r static/h5.html static/h6.html && cp -r static webpush " 
    }
    stage("deploy to server") {
        sshRemove remote: remote, path: "/apps/www/webpush"
        sshRemove remote: remote, path: "/apps/www/h5push"
        sshPut remote: remote, from: "webpush", into: "/apps/www/"
        sshPut remote: remote, from: "dist/access.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/h5.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "static/gio_hybrid_cdp.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/1.1", into: "/apps/www/webpush/"
    }
    stage("build") {
        sh "npm cache clean --force && npm install && node bin/build.js  -h='test-browser.growingio.com/webpush' -d='k8s-qa-messages.growingio.com' -vs && cp -r static/h5.html static/h6.html && cp -r static webpush && cp -r dist/access.latest.js dist/qa.latest.js && cp -r dist/h5.latest.js dist/h5.qa.latest.js" 
        sh "sed -i 's/access.latest.js/qa.latest.js/g' webpush/index.html"
        sh "sed -i 's/access.latest.js/h5.qa.latest.js/g' webpush/h5.html"
        sh "sed -i 's/access.latest.js/h5.qa.latest.js/g' webpush/h6.html"
    }
    stage("deploy to server") {
        sshRemove remote: remote, path: "/apps/www/qa/webpush"
        sshRemove remote: remote, path: "/apps/www/qa/h5push"
        sshPut remote: remote, from: "webpush", into: "/apps/www/qa/"
        sshPut remote: remote, from: "dist/qa.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/h5.qa.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/1.1", into: "/apps/www/qa/webpush/"
      }
    } else{
        stage("build") {
        sh "node -v"
        sh "npm cache clean --force && npm install && node bin/build.js  -v  && cp -r static/cdp/h5.html static/cdp/h6.html && cp -r static webpush " 
    }
     stage("deploy to server") {
        sshRemove remote: remote, path: "/apps/www/webpush"
        sshRemove remote: remote, path: "/apps/www/h5push"
        sshPut remote: remote, from: "webpush", into: "/apps/www/"
        sshPut remote: remote, from: "dist/access.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/h5.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/gtouch.latest.js", into: "/apps/www/"
        sshPut remote: remote, from: "static/gio_hybrid_cdp.js", into: "/apps/www/"
        sshPut remote: remote, from: "dist/1.1", into: "/apps/www/webpush/"
    }
    }
  }
}

```

0709æµ‹è¯•å‘ç°é—®é¢˜ jsåŸ‹ç‚¹åœ¨æ‰§è¡ŒclearUserIdæ–¹æ³•åæ²¡æœ‰æ¸…æ¥šcookieé‡Œçš„gioId

## cdpæ€»ä½“ç¯å¢ƒ
![](2020-07-09-19-29-44.png)

## å·¥ä½œéœ€è¦ä½œå“
- è¿‡å¿ƒ
- è¿‡è„‘

## android diffè‡ªåŠ¨lintè§„èŒƒ

å¤§æ¦‚æ€è·¯æ˜¯ä¿®æ”¹ https://codes.growingio.com/source/arc-support/browse/master/src/linters/ ä¸­çš„ ArcanistAndroidLinter.php ç„¶ååœ¨é¡¹ç›®é‡Œé¢é…ç½®ç›¸åº”çš„ .arclint ã€‚ç„¶åæ¯æ¬¡æ diff çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ lint æ£€æŸ¥ã€‚ç°åœ¨è¿™ä¸ªå®ç°ä¸çŸ¥é“æ˜¯è°å†™çš„ï¼Œæˆ‘è¯•äº†ä¸‹ä¼šæŠ¥é”™ã€‚å¯ä»¥å‚è€ƒè¿™ä¸ªæ”¹ä¸‹ã€‚https://github.com/DheerendraRathor/Arcanist-Android-Lint

## ä¿®æ”¹æŸé¡µé¢çš„æ–‡æ¡£
æ–‡æ¡£å‘ç‰ˆjob
http://test-browser.growingio.com:8080/view/%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/job/docs_deploy/

å‘å¸ƒæŒ‡å®šé¡µé¢çš„æ–¹æ³•åœ¨ï¼Œjobçš„é…ç½®é‡Œæ·»åŠ ä¸€è¡Œ 
/usr/bin/python docs_deploy.py --project docs --page  developer-manual/debugging/web-debugger

å¢é•¿å¹³å°çº¿ä¸Šæ–‡æ¡£
https://growingio.gitbook.io/cdp/developer-manual/sdkintegrated/cdp/hybrid-sdk

æ–‡æ¡£ä¿®æ”¹gitbook
https://app.gitbook.com/@growingio/spaces


## å°ç¨‹åºsdk
æ–‡æ¡£ï¼šã€ŠSAAS å°ç¨‹åº SDK å‘å¸ƒæµç¨‹ã€‹æ¯æ¬¡å‘ç‰ˆå®Œç»´æŠ¤ å°ç¨‹åºsdkå‘ç‰ˆè®°å½• è¡¥å‘ä¸€æ¡ç ”å‘release-noteï¼Œå¾®ä¿¡å†…åµŒé¡µ saas-1.0 saas-2.0 saaså°ç¨‹åºã€‚å†™åˆ°codesçš„ä¸Šçº¿è®°å½•é‡Œã€‚

1 saas cdpä»“åº“éƒ½æ˜¯master
2 å°ç¨‹åºdemo
3 å°ç¨‹åº sdk åœ¨SDK-Beta jobç›®å½•ä¸‹æœ‰ä¸ªé¢„å‘å¸ƒjobï¼Œè®©sreå‘å®Œåçœ‹ä¸ªç‰ˆæœ¬å·ï¼Œå¯¹ä¸Šäº†å°±æ­£å¼å‘ã€‚

## 0722
1 å‘SDK å›å½’SaaSï¼Œç™»å½•/è®¿é—®ç”¨æˆ·å±æ€§å¼¹çª—ï¼ŒcdpåŸ‹ç‚¹ï¼Œcdpè§¦è¾¾
2 

## CDPç¯å¢ƒè¯·æ±‚å¼¹çª—
``` shell
http://gdp-test.growingio.com/marketing/automation/v3/a500f222e29e3b0c/notifications?
# å…¨éƒ¨è®¿é—®ç”¨æˆ·ï¼šå¼¹çª—20200410134008
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7
# å…¨éƒ¨ç™»å½•ç”¨æˆ·ï¼šå¼¹çª—20200410134310
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing
# æ–°ç™»å½•ç”¨æˆ·ï¼šå¼¹çª—20200410134358
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=test20200410
# æ–°è®¿é—®ç”¨æˆ·ï¼šå¼¹çª—20200410134500
url_scheme=growing.2474efffeddbd34e&u=test20200410&cs=test20200410
# å°æ˜ï¼šå¼¹çª—20200410134541
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing
# tag:å¼¹çª—20200410134714
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing

# AB
# åˆ†ç¾¤å¯¹æ¯”ï¼šå¼¹çª—20200410134905
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing
# å…¨éƒ¨è®¿é—®æ§åˆ¶ç»„ï¼šå¼¹çª—20200410135024
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing
# tagç´ æå¯¹æ¯”ï¼šå¼¹çª—20200410135131
url_scheme=growing.2474efffeddbd34e&u=1f27c8ca-d57d-38f3-b1f8-dd6a5dc9e2c7&cs=XiaoMing

```

## é¢„è§ˆå¼¹çª—çš„è§„åˆ™
https://growingio.atlassian.net/wiki/spaces/MP/pages/986644963
 app&å°ç¨‹åº é»˜è®¤æ”¯æŒ äº‹ä»¶è§¦å‘
 web&h5 é»˜è®¤æ”¯æŒ äº‹ä»¶è§¦å‘+äº‹ä»¶å±æ€§+delay


 ## æœ¬åœ°å‘cdpè§¦è¾¾
 ```
#!/bin/bash

echo      "*********************************************************************************************************"
echo      "*                                                                                                       *"
echo -e   "*    \033[41;37m æ­¤è„šæœ¬ä¸ºå‘å¸ƒæ‰€æœ‰è§¦è¾¾SDKåˆ°çº¿ä¸Šç¯å¢ƒï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼ï¼ï¼ \033[0m                                              *"
echo      "*                                                                                                       *"
echo      "*    1ã€è¯·ç¡®ä¿å·²ç»æµ‹è¯•é€šè¿‡                                                                              *"
echo      "*                                                                                                       *"
echo -e   "*    2ã€è¯·ç¡®ä¿å·²ç»æ‰§è¡Œè¿‡\033[41;37m publishAllToMavenLocal.sh \033[0mè„šæœ¬ä¸”æµ‹è¯•é€šè¿‡                                       *"
echo      "*                                                                                                       *"
echo      "*********************************************************************************************************"
echo ""

echo -n "è¯·ç¡®ä¿å·²ç»æµ‹è¯•é€šè¿‡?[Y/n]:"
read TEST_RESULT
if [[ ${TEST_RESULT} != 'Y' ]] ; then
    echo "æ²¡æœ‰æµ‹è¯•é€šè¿‡ï¼Ÿé‚£å°±å›å»å¥½å¥½æµ‹å§ï¼"
    exit 1
fi
echo ""

echo -n "è¯·ç¡®ä¿å·²ç»æ‰§è¡Œè¿‡ publishAllToMavenLocal.sh è„šæœ¬ä¸”æµ‹è¯•é€šè¿‡?[Y/n]:"
read PUBLISH_MAVEN_LOCAL
if [[ ${PUBLISH_MAVEN_LOCAL} != 'Y' ]] ; then
    echo "æ²¡æœ‰æ‰§è¡Œï¼Ÿé‚£å°±å…ˆæ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå†ä»”ç»†æµ‹è¯•ä¸‹ï¼"
    exit 1
fi
echo ""

echo -n "æ—¢ç„¶éƒ½åˆ°è¿™ä¸€æ­¥äº†ï¼Œé‚£ç°åœ¨ã€ç«‹åˆ»ã€é©¬ä¸Šå‘å¸ƒè§¦è¾¾SDKåˆ°çº¿ä¸Š?[Y/n]:"
read PUBLISH_JCENTER
if [[ ${PUBLISH_JCENTER} != 'Y' ]] ; then
    echo "ä¸æ•¢å‘ç‰ˆï¼Ÿæ€•èƒŒé”…ï¼Ÿé‚£å°±å†å¥½å¥½æµ‹è¯•ä¸‹å§ï¼"
    exit 1
fi
echo ""
export IS_CDP_ENVIRONMENT=true
export IS_RELEASE_BUILDING=true

NAME="lishaojie"
KEY="0727165e3b3edfb6038c8cb1caaa599479bcbb5c"

./gradlew clean  \
&& ./gradlew :gmonitor:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-core:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-hms-agent:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-huawei-adapter:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-meizu-adapter:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-mipush-sdk:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-xiaomi-adapter:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-oppo-sdk:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-oppo-adapter:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-vivo-sdk:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gpush-vivo-adapter:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :gtouch:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false \
&& ./gradlew :banner:bintrayUpload -PbintrayUser=$NAME -PbintrayKey=$KEY -PdryRun=false
echo ""

echo -e "\033[32;1må‘ç‰ˆå®Œæˆï¼Œèµ¶ç´§æµ‹è¯•çº¿ä¸ŠSDKæ˜¯å¦æ­£å¸¸ï¼\033[0m"


 ```

 ## æœ¬åœ°å‘åŸ‹ç‚¹cdp
 ```
#!/usr/bin/env bash

# ç”¨äºå‘å¸ƒAndroid SDKåˆ°jcenterä¸Š
# æ­¤è„šæœ¬éœ€è¦ç¯å¢ƒå˜é‡å¦‚ä¸‹:
# pb_pf: å‘å¸ƒæ–¹å¼ï¼š test official
# pb_vs: å‘å¸ƒç‰ˆæœ¬
# pb_vaa: æ˜¯å¦å‘å¸ƒvds-android-agent
# pb_vgp: æ˜¯å¦å‘å¸ƒgradle-plugin
# pb_all: æ˜¯å¦éœ€å…¨é‡å‘å¸ƒ

set -e
pb_pf="official"
pb_vs="cdp-1.2.3"
pb_vaa=true
pb_rva=false
pb_vgp=false
pb_all=false

function publish(){
	versionName=$1
  
	echo "å¼€å§‹å‘å¸ƒç‰ˆæœ¬:" $versionName
	# bintrayUploadä¼šé¦–å…ˆåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  #./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp clean assembleAar :vds-gradle-plugin:install
	./gradlew -P pb_vs=$versionName -P pb_pf=$pb_pf -P pb_vaa=$pb_vaa -P pb_vgp=$pb_vgp bintrayUpload --info
}

if [ "$pb_all" == "true" ]
then
	echo "å‘å¸ƒå…¨é‡ç‰ˆæœ¬ï¼š RN-autotrack-"$pb_vs ", autotrack-"$pb_vs ", RN-track-"$pb_vs ", track-"$pb_vs
	publish RN-autotrack-$pb_vs
	publish RN-track-$pb_vs
	publish track-$pb_vs
	publish autotrack-$pb_vs
else
	echo "å‘å¸ƒå•ä¸ªç‰ˆæœ¬ï¼š" $pb_vs
	publish $pb_vs
fi   

echo "================== å‘å¸ƒå®Œæˆ ==================== "
 ```

 ## GIOé¡¹ç›®å‘ç‰ˆå¤±è´¥
 - ä¸€èˆ¬æ˜¯vds-agent æ¨¡å—çš„assembaarå‡ºäº†é—®é¢˜ã€‚ä¼šæŠ¥æŸä¸ªæ¨¡å—çš„ç±»æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œæ­¤æ—¶éœ€è¦æ‰‹åŠ¨å»å¯¹åº”æ¨¡å—æ‰§è¡ŒbundLibRuntimeDebug

## åœˆé€‰æ€ä¹ˆæµ‹
webå…¨appçš„h5é¡µé¢æ—¶ï¼Œä¼šåŒæ—¶è¯·æ±‚
https://assets.giocdn.com/sdk/hybrid/2.0/gio_hybrid.min.js
http://test-browser.growingio.com/push/saas/gio_hybrid.min.js

é¢„å‘å¸ƒbetaç‰ˆ
https://assets.giocdn.com/sdk/hybrid/2.0/gio_hybrid.min-beta.js

ä¸
https://assets.giocdn.com/sdk/hybrid/2.0/vds_web_circle_plugin.min.js
http://test-browser.growingio.com/push/saas/vds_web_circle_plugin.min.js



## CDPæ”¯æŒAPIæ¨é€
- æ¨é€SDKçš„æ¨é€ç‚¹å‡»äº‹ä»¶éœ€è¦å¢åŠ ä¸ŠæŠ¥ä¸€ä¸ªcollectDataå­—æ®µï¼Œå¸¦ä¸Šæ¨é€ç±»å‹ä¸api_id.

## å®‰è£…python3ä¸python2çš„åŒ…
ä½¿ç”¨python3 å®‰è£…æ¨¡å—
- python3 -m pip install DingtalkChatbot
ä½¿ç”¨python2 å®‰è£…æ¨¡å—
- python -m pip install DingtalkChatbot
ä½¿ç”¨python3å®‰è£…pip3
- python3 -m pip install --upgrade pip
ä½¿ç”¨pip3æ›´æ–°pip
- sudo pip3 install --upgrade pip         

## æ·±åº¦é“¾æ¥æ€ä¹ˆæµ‹
- åˆ›å»ºçº¿ä¸Šçš„é“¾æ¥
- sdkåˆå§‹åŒ–è®¾ç½®.setReportHost("https://testlink.growingio.com")
- æŠ“åŒ…ï¼Œçº¿ä¸Šé»˜è®¤çš„æ˜¯t,growingio.com/app


## Linuxå‘½ä»¤åˆ†äº«


## TestLinkä½¿ç”¨å¿ƒå¾—
- å…è®¸ç¼–è¾‘æµ‹è¯•è§„èŒƒã€å…³é”®è¯ã€éœ€æ±‚ã€æµ‹è¯•æ‰§è¡Œã€æµ‹è¯•è®¡åˆ’ï¼ˆåŒ…æ‹¬ä¼˜å…ˆçº§ã€é‡Œç¨‹ç¢‘å’Œåˆ†é…è®¡åˆ’ï¼‰ä»¥åŠå‘å¸ƒ 

## githubçš„acæ–¹æ³•

- add your review
- approve

## ç ´è§£apkçš„æ–¹æ³•
- apkå°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…
- è§£å‹åæ‰¾åˆ°class.dexæ–‡ä»¶ é€šè¿‡d2jå·¥å…·å°†å…¶è½¬åŒ–ä¸ºjaråŒ…
- åœ¨é€šè¿‡JD-GUIå·¥å…·æŸ¥çœ‹jaråŒ…å†…å®¹

## å®‰å“annotation

## cdp å°ç¨‹åºå‘ç‰ˆæµç¨‹
- æ‰¾åˆ°release-notesç”Ÿæˆjob
- æ‰¾åˆ°å‘ç‰ˆjob
- æ‰¾åˆ°codeså‘ç‰ˆè®°å½•
- æ‰¾åˆ°wikiä¸Šçš„ä»¥å‰çš„è®°å½•
- æœ¬åœ°runä¸€ä¸‹demo

## jenkinsè¯»å–å‚æ•°
- jenkinsé…å­—ç¬¦ä¸²å‚æ•°æ—¶æœ€å¥½å¸¦ç”¨åŒå¼•å·"$arg",ç”¨$argçš„è¯ï¼Œä¸‡ä¸€è¾“å…¥çš„argä¸­é—´å¸¦äº†ç©ºæ ¼ï¼Œjenkinsåœ¨æ•´ä½“å‚æ•°æ›¿æ¢åˆ°jobé‡Œæ—¶ï¼Œä¼šè®¤ä¸ºç©ºæ ¼åé¢çš„å†…å®¹æ˜¯å˜é‡ï¼Œå¯¼è‡´æŠ¥äº†unsigned argumenté”™è¯¯ã€‚


## å®‰å“æ‰“åŒ…åä»£ç æ²¡æœ‰ç”Ÿæ•ˆ
- syncåéœ€è¦cleanä¸€ä¸‹ï¼Œæ¸…é™¤ä¸€ä¸‹ç¼“å­˜
- å†é‡æ–°æ‰“åŒ…


## 3.0 demoè¿è¡Œå¼‚å¸¸
- demoä¾èµ–å·¥ç¨‹sdkæºç ä¸æœ¬åœ°plugin
- éœ€è¦æ‰§è¡Œgrowing-autotraker:assemble é‡æ–°ç”Ÿæˆä¸€ä¸‹configæ–‡ä»¶